<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    
    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="SMIT ‚Äî –ò–Ω—Ç–µ—Ä–Ω–µ—Ç-–ø—Ä–æ–≤–∞–π–¥–µ—Ä –±—É–¥—É—â–µ–≥–æ">
    <meta property="og:description" content="–°—Ç–∞–±–∏–ª—å–Ω—ã–π –ò–Ω—Ç–µ—Ä–Ω–µ—Ç –≤ –í–æ–ª–≥–æ–≥—Ä–∞–¥—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏. –ë–µ—Å–ø–ª–∞—Ç–Ω–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫–≤–∞—Ä—Ç–∏—Ä –∏ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è GPON –≤ —á–∞—Å—Ç–Ω—ã–π —Å–µ–∫—Ç–æ—Ä.">
    <meta property="og:image" content="https://storage.googleapis.com/uspeshnyy-projects/smit/smit34.ru/ogimage.jpg">
    <meta property="og:url" content="https://smit34.ru">
    <meta property="og:type" content="website">
    <meta property="og:locale" content="ru_RU">
    
    <!-- Twitter Card data -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="SMIT ‚Äî –ò–Ω—Ç–µ—Ä–Ω–µ—Ç-–ø—Ä–æ–≤–∞–π–¥–µ—Ä –±—É–¥—É—â–µ–≥–æ">
    <meta name="twitter:description" content="–°—Ç–∞–±–∏–ª—å–Ω—ã–π –ò–Ω—Ç–µ—Ä–Ω–µ—Ç –≤ –í–æ–ª–≥–æ–≥—Ä–∞–¥—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å —Å–µ–≥–æ–¥–Ω—è!">
    <meta name="twitter:image" content="https://storage.googleapis.com/uspeshnyy-projects/smit/smit34.ru/ogimage.jpg">

    <title>SMIT ‚Äî –ò–Ω—Ç–µ—Ä–Ω–µ—Ç-–ø—Ä–æ–≤–∞–π–¥–µ—Ä –±—É–¥—É—â–µ–≥–æ</title>
    
    <!-- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class', // –í–∫–ª—é—á–∞–µ–º —Ä–µ–∂–∏–º dark mode —á–µ—Ä–µ–∑ –∫–ª–∞—Å—Å
            theme: {
                extend: {
                    colors: {
                        slate: {
                            850: '#1e293b', // Custom dark shade
                            950: '#020617',
                        }
                    }
                }
            }
        }
    </script>

    <!-- –°–∫—Ä–∏–ø—Ç –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ç–µ–º—ã —Å–∏—Å—Ç–µ–º—ã (–≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –¥–æ –∑–∞–≥—Ä—É–∑–∫–∏ React) -->
    <script>
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º localStorage –∏–ª–∏ —Å–∏—Å—Ç–µ–º–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
        if (localStorage.theme === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
            document.documentElement.classList.add('dark');
        } else {
            document.documentElement.classList.remove('dark');
        }
    </script>
    
    <!-- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ React –∏ ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ Babel -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ GSAP -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>

    <!-- Google GenAI SDK –¥–ª—è –≥–æ–ª–æ—Å–æ–≤–æ–≥–æ –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞ -->
    <script type="importmap">
    {
        "imports": {
            "@google/genai": "https://esm.sh/@google/genai@0.14.0"
        }
    }
    </script>
    <script type="module">
        import { GoogleGenAI, Modality } from '@google/genai';
        window.GoogleGenAI = GoogleGenAI;
        window.GeminiModality = Modality;
    </script>

    <style>
        html {
            overflow-x: hidden;
        }
        body {
            overflow-x: hidden;
            background-color: #f8fafc; /* Fallback for light mode */
            margin: 0;
            transition: background-color 0.3s ease;
        }
        
        /* Dark mode body transition handled by Tailwind classes on div wrapper */

        /* –ê–Ω–∏–º–∞—Ü–∏—è –ª–µ–≤–∏—Ç–∞—Ü–∏–∏ */
        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-15px); }
        }
        .animate-float {
            animation: float 4s ease-in-out infinite;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –∞–∫–∫–æ—Ä–¥–µ–æ–Ω–∞ */
        details > summary {
            list-style: none;
        }
        details > summary::-webkit-details-marker {
            display: none;
        }
        details[open] summary ~ * {
            animation: slideDown 0.3s ease-in-out;
        }
        @keyframes slideDown {
            0% { opacity: 0; transform: translateY(-10px); }
            100% { opacity: 1; transform: translateY(0); }
        }

        /* Fallback –∞–Ω–∏–º–∞—Ü–∏–∏ */
        .animate-in { animation-duration: 0.7s; animation-fill-mode: backwards; animation-timing-function: cubic-bezier(0.4, 0, 0.2, 1); }
        .fade-in { animation-name: fadeIn; }
        .slide-in-from-bottom-4 { animation-name: slideInFromBottom; }
        @media (max-width: 639px) {
            /* –¢–æ–ª—å–∫–æ –∫–æ–≥–¥–∞ –≤–∏–¥–∂–µ—Ç –æ—Ç–∫—Ä—ã—Ç ‚Äî –ø–æ–ª–Ω—ã–π —ç–∫—Ä–∞–Ω */
            #ai-widget-panel.ai-widget-open {
                position: fixed !important;
                inset: 0 !important;
                width: 100% !important;
                height: 100dvh !important;
                max-height: 100dvh !important;
                margin: 0 !important;
                border-radius: 0 !important;
            }
            .ai-widget-toggle {
                position: fixed !important;
                bottom: 1.5rem !important;
                right: 1.5rem !important;
            }
            .ai-widget-toggle-open {
                display: none !important;
            }
        }
        .slide-in-from-left { animation-name: slideInFromLeft; }
        .slide-in-from-right { animation-name: slideInFromRight; }
        .fill-mode-backwards { animation-fill-mode: backwards; }
        
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes slideInFromBottom { from { transform: translateY(1rem); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        @keyframes slideInFromLeft { from { transform: translateX(-100%); opacity: 0; } to { transform: translateX(0); opacity: 1; } }
        @keyframes slideInFromRight { from { transform: translateX(100%); opacity: 0; } to { transform: translateX(0); opacity: 1; } }

        .glass-text { text-shadow: 0 2px 10px rgba(16, 185, 129, 0.1); }
        
        /* –ö–∞—Å—Ç–æ–º–Ω—ã–π —Å–∫—Ä–æ–ª–ª–±–∞—Ä –¥–ª—è –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω */
        .custom-scroll::-webkit-scrollbar { width: 6px; }
        .custom-scroll::-webkit-scrollbar-track { background: #f1f5f9; border-radius: 4px; }
        .custom-scroll::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
        .custom-scroll::-webkit-scrollbar-thumb:hover { background: #94a3b8; }
        
        /* Dark mode scrollbar */
        .dark .custom-scroll::-webkit-scrollbar-track { background: #1e293b; }
        .dark .custom-scroll::-webkit-scrollbar-thumb { background: #475569; }
        .dark .custom-scroll::-webkit-scrollbar-thumb:hover { background: #64748b; }

        #error-display { padding: 20px; color: red; font-family: monospace; display: none; }
    </style>
</head>
<body class="transition-colors duration-300 dark:bg-slate-950">
    <!-- Yandex.Metrika counter -->
    <script type="text/javascript">
        (function(m,e,t,r,i,k,a){
            m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
            m[i].l=1*new Date();
            for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}
            k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)
        })(window, document,'script','https://mc.yandex.ru/metrika/tag.js?id=105460811', 'ym');

        ym(105460811, 'init', {ssr:true, webvisor:true, clickmap:true, ecommerce:"dataLayer", referrer: document.referrer, url: location.href, accurateTrackBounce:true, trackLinks:true});
    </script>
    <noscript><div><img src="https://mc.yandex.ru/watch/105460811" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
    <!-- /Yandex.Metrika counter -->
    
    <div id="root"></div>
    <div id="error-display"></div>

    <script type="text/babel" data-presets="env,react">
        try {
            const { useState, useEffect, useRef, useMemo } = React;

            // Helper for Metrika goals
            const trackGoal = (target) => {
                if (typeof window.ym === 'function') {
                    console.log('Goal reached:', target); 
                    window.ym(105460811, 'reachGoal', target);
                }
            };

            // --- –ö–û–ú–ü–û–ù–ï–ù–¢ –ò–ö–û–ù–ö–ò ---
            const Icon = ({ children, size = 24, className = "", ...props }) => (
                <svg 
                    xmlns="http://www.w3.org/2000/svg" 
                    width={size} 
                    height={size} 
                    viewBox="0 0 24 24" 
                    fill="none" 
                    stroke="currentColor" 
                    strokeWidth="2" 
                    strokeLinecap="round" 
                    strokeLinejoin="round" 
                    className={className}
                    {...props}
                >
                    {children}
                </svg>
            );

            // --- –ë–ò–ë–õ–ò–û–¢–ï–ö–ê –ò–ö–û–ù–û–ö ---
            const Icons = {
                Menu: (p) => <Icon {...p}><line x1="4" x2="20" y1="12" y2="12"/><line x1="4" x2="20" y1="6" y2="6"/><line x1="4" x2="20" y1="18" y2="18"/></Icon>,
                X: (p) => <Icon {...p}><path d="M18 6 6 18"/><path d="m6 6 12 12"/></Icon>,
                Check: (p) => <Icon {...p}><path d="M20 6 9 17l-5-5"/></Icon>,
                Phone: (p) => <Icon {...p}><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/></Icon>,
                User: (p) => <Icon {...p}><path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></Icon>,
                CreditCard: (p) => <Icon {...p}><rect width="20" height="14" x="2" y="5" rx="2"/><line x1="2" x2="22" y1="10" y2="10"/></Icon>,
                Wifi: (p) => <Icon {...p}><path d="M5 12.55a11 11 0 0 1 14.08 0"/><path d="M1.42 9a16 16 0 0 1 21.16 0"/><path d="M8.53 16.11a6 6 0 0 1 6.95 0"/><line x1="12" x2="12.01" y1="20" y2="20"/></Icon>,
                Monitor: (p) => <Icon {...p}><rect width="20" height="14" x="2" y="3" rx="2"/><line x1="8" x2="16" y1="21" y2="21"/><line x1="12" x2="12" y1="17" y2="21"/></Icon>,
                Shield: (p) => <Icon {...p}><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10"/></Icon>,
                Zap: (p) => <Icon {...p}><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></Icon>,
                Download: (p) => <Icon {...p}><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" x2="12" y1="15" y2="3"/></Icon>,
                MapPin: (p) => <Icon {...p}><path d="M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z"/><circle cx="12" cy="10" r="3"/></Icon>,
                Clock: (p) => <Icon {...p}><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></Icon>,
                Mail: (p) => <Icon {...p}><rect width="20" height="16" x="2" y="4" rx="2"/><path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"/></Icon>,
                ChevronRight: (p) => <Icon {...p}><path d="m9 18 6-6-6-6"/></Icon>,
                ChevronLeft: (p) => <Icon {...p}><path d="m15 18-6-6 6-6"/></Icon>,
                ChevronDown: (p) => <Icon {...p}><path d="m6 9 6 6 6-6"/></Icon>,
                Server: (p) => <Icon {...p}><rect width="20" height="8" x="2" y="2" rx="2" ry="2"/><rect width="20" height="8" x="2" y="14" rx="2" ry="2"/><line x1="6" x2="6.01" y1="6" y2="6"/><line x1="6" x2="6.01" y1="18" y2="18"/></Icon>,
                MousePointer: (p) => <Icon {...p}><path d="m3 3 7.07 16.97 2.51-7.39 7.39-2.51L3 3z"/><path d="m13 13 6 6"/></Icon>,
                ArrowRight: (p) => <Icon {...p}><path d="M5 12h14"/><path d="m12 5 7 7-7 7"/></Icon>,
                FileText: (p) => <Icon {...p}><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/></Icon>,
                Tv: (p) => <Icon {...p}><rect width="20" height="15" x="2" y="7" rx="2" ry="2"/><polyline points="17 2 12 7 7 2"/></Icon>,
                Cpu: (p) => <Icon {...p}><rect x="4" y="4" width="16" height="16" rx="2"/><rect x="9" y="9" width="6" height="6"/><path d="M15 2v2"/><path d="M15 20v2"/><path d="M2 15h2"/><path d="M2 9h2"/><path d="M20 15h2"/><path d="M20 9h2"/><path d="M9 2v2"/><path d="M9 20v2"/></Icon>,
                HardDrive: (p) => <Icon {...p}><line x1="22" x2="2" y1="12" y2="12"/><path d="M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z"/><line x1="6" x2="6.01" y1="16" y2="16"/><line x1="10" x2="10.01" y1="16" y2="16"/></Icon>,
                Bot: (p) => <Icon {...p}><rect width="18" height="10" x="3" y="11" rx="2" /><circle cx="12" cy="5" r="2" /><path d="M12 7v4" /><line x1="8" x2="8" y1="16" y2="16" /><line x1="16" x2="16" y1="16" y2="16" /></Icon>,
                File: (p) => <Icon {...p}><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z" /><polyline points="14 2 14 8 20 8" /></Icon>,
                Cookie: (p) => <Icon {...p}><path d="M12 2a10 10 0 1 0 10 10 4 4 0 0 1-5-5 4 4 0 0 1-5-5" /><path d="M8.5 8.5v.01" /><path d="M16 15.5v.01" /><path d="M12 12v.01" /><path d="M11 17v.01" /><path d="M7 14v.01" /></Icon>,
                Mic: (p) => <Icon {...p}><path d="M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z"/><path d="M19 10v2a7 7 0 0 1-14 0v-2"/><line x1="12" x2="12" y1="19" y2="22"/></Icon>,
                Square: (p) => <Icon {...p}><rect width="18" height="18" x="3" y="3" rx="2"/></Icon>,
                Loader2: (p) => <Icon {...p} className={`${p.className || ''} animate-spin`}><path d="M21 12a9 9 0 1 1-6.219-8.56"/></Icon>,
                Settings: (p) => <Icon {...p}><path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.38a2 2 0 0 0-.73-2.73l-.15-.1a2 2 0 0 1-1-1.72v-.51a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"></path><circle cx="12" cy="12" r="3"></circle></Icon>,
                Moon: (p) => <Icon {...p}><path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"/></Icon>,
                Sun: (p) => <Icon {...p}><circle cx="12" cy="12" r="4"/><path d="M12 2v2"/><path d="M12 20v2"/><path d="m4.93 4.93 1.41 1.41"/><path d="m17.66 17.66 1.41 1.41"/><path d="M2 12h2"/><path d="M20 12h2"/><path d="m6.34 17.66-1.41 1.41"/><path d="m19.07 4.93-1.41 1.41"/></Icon>
            };

            const {
                Menu, X, Check, Phone, User, CreditCard,
                Wifi, Monitor, Shield, Zap, Download,
                MapPin, Clock, Mail, ChevronRight, ChevronLeft, ChevronDown, Server,
                MousePointer, ArrowRight, FileText,
                Tv, Cpu, HardDrive, Bot, File, Cookie, Settings, Moon, Sun,
                Mic, Square, Loader2
            } = Icons;

            // --- 3D –§–û–ù (CANVAS) ---
            const GeometricBackground = ({ isDark }) => {
                const canvasRef = useRef(null);
                
                useEffect(() => {
                    const canvas = canvasRef.current;
                    if (!canvas) return;
                    const ctx = canvas.getContext('2d');
                    let animationFrameId;

                    let width = window.innerWidth;
                    let height = window.innerHeight;

                    const nodes = [];
                    const nodeCount = 50; 
                    const connectionDistance = 300; 
                    const perspective = 800;
                    
                    let mouseX = 0;
                    let mouseY = 0;
                    let scrollY = 0;

                    const handleResize = () => {
                        width = window.innerWidth;
                        height = window.innerHeight;
                        canvas.width = width;
                        canvas.height = height;
                    };
                    window.addEventListener('resize', handleResize);
                    handleResize();

                    const handleMouseMove = (e) => {
                        mouseX = (e.clientX - width / 2) * 0.0005; 
                        mouseY = (e.clientY - height / 2) * 0.0005;
                    };
                    window.addEventListener('mousemove', handleMouseMove);

                    const handleScroll = () => {
                        scrollY = window.scrollY;
                    };
                    window.addEventListener('scroll', handleScroll);

                    class NetworkNode {
                        constructor() {
                            this.x = (Math.random() - 0.5) * width * 1.5;
                            this.y = (Math.random() - 0.5) * height * 1.5;
                            this.z = (Math.random() - 0.5) * 1000;
                            this.vx = (Math.random() - 0.5) * 0.3; 
                            this.vy = (Math.random() - 0.5) * 0.3;
                            this.vz = (Math.random() - 0.5) * 0.3;
                            this.size = Math.random() * 3 + 2; 
                            this.color = Math.random() > 0.5 ? '#059669' : '#10b981'; 
                        }

                        rotate(x, y, z, rX, rY) {
                            let dy = y * Math.cos(rX) - z * Math.sin(rX);
                            let dz = y * Math.sin(rX) + z * Math.cos(rX);
                            y = dy;
                            z = dz;
                            let dx = x * Math.cos(rY) - z * Math.sin(rY);
                            dz = x * Math.sin(rY) + z * Math.cos(rY);
                            x = dx;
                            z = dz;
                            return {x, y, z};
                        }

                        project(x, y, z) {
                            const scale = perspective / (perspective + z + 1000);
                            return {
                                x: width / 2 + x * scale,
                                y: height / 2 + y * scale,
                                scale: scale,
                                z: z 
                            };
                        }

                        update(rotationX, rotationY, scrollFactor) {
                            this.x += this.vx;
                            this.y += this.vy;
                            this.z += this.vz;
                            // Boundary checks
                            const limit = 1000;
                            if (this.x > limit) this.x = -limit;
                            if (this.x < -limit) this.x = limit;
                            if (this.y > limit) this.y = -limit;
                            if (this.y < -limit) this.y = limit;
                            if (this.z > limit) this.z = -limit;
                            if (this.z < -limit) this.z = limit;

                            const currentRX = rotationX + scrollFactor * 0.0005;
                            const currentRY = rotationY + scrollFactor * 0.0005;
                            
                            const rotated = this.rotate(this.x, this.y, this.z, currentRX, currentRY);
                            return this.project(rotated.x, rotated.y, rotated.z);
                        }
                    }

                    // Initialize nodes
                    for(let i = 0; i < nodeCount; i++) {
                        nodes.push(new NetworkNode());
                    }

                    let globalRotationX = 0;
                    let globalRotationY = 0;

                    const render = () => {
                        ctx.clearRect(0, 0, width, height);
                        
                        globalRotationX += 0.0005;
                        globalRotationY += 0.0005;

                        const rX = globalRotationX + mouseY;
                        const rY = globalRotationY + mouseX;

                        const projectedNodes = nodes.map(node => ({
                            ...node.update(rX, rY, scrollY),
                            ref: node 
                        }));

                        ctx.lineWidth = 1.2; 
                        for (let i = 0; i < projectedNodes.length; i++) {
                            const p1 = projectedNodes[i];
                            if (p1.scale < 0) continue;

                            for (let j = i + 1; j < projectedNodes.length; j++) {
                                const p2 = projectedNodes[j];
                                if (p2.scale < 0) continue;

                                const dx = p1.x - p2.x;
                                const dy = p1.y - p2.y;
                                const dist = Math.sqrt(dx * dx + dy * dy);

                                if (dist < connectionDistance * p1.scale) {
                                    const alpha = (1 - dist / (connectionDistance * p1.scale)); 
                                    ctx.beginPath();
                                    ctx.moveTo(p1.x, p1.y);
                                    ctx.lineTo(p2.x, p2.y);
                                    
                                    // Change line color based on theme
                                    if (isDark) {
                                        ctx.strokeStyle = `rgba(52, 211, 153, ${alpha * 0.4})`; // Brighter/lighter green for dark mode
                                    } else {
                                        ctx.strokeStyle = `rgba(5, 150, 105, ${alpha * 0.6})`; 
                                    }
                                    
                                    ctx.stroke();
                                }
                            }
                        }

                        for (let i = 0; i < projectedNodes.length; i++) {
                            const p1 = projectedNodes[i];
                            if (p1.scale < 0) continue;
                            ctx.beginPath();
                            ctx.arc(p1.x, p1.y, p1.ref.size * p1.scale, 0, Math.PI * 2);
                            ctx.fillStyle = p1.ref.color;
                            // Add glow for dark mode
                            if (isDark) {
                                ctx.shadowBlur = 10;
                                ctx.shadowColor = p1.ref.color;
                            } else {
                                ctx.shadowBlur = 0;
                            }
                            ctx.globalAlpha = 0.9; 
                            ctx.fill();
                            ctx.shadowBlur = 0; // Reset
                        }
                        
                        ctx.globalAlpha = 1;
                        animationFrameId = requestAnimationFrame(render);
                    };

                    render();

                    return () => {
                        window.removeEventListener('resize', handleResize);
                        window.removeEventListener('mousemove', handleMouseMove);
                        window.removeEventListener('scroll', handleScroll);
                        cancelAnimationFrame(animationFrameId);
                    };
                }, [isDark]);

                return (
                    <canvas 
                        ref={canvasRef} 
                        className="fixed top-0 left-0 w-full h-full -z-10 pointer-events-none bg-slate-50 dark:bg-slate-950 transition-colors duration-500"
                    />
                );
            };

            // --- –ö–û–ú–ü–û–ù–ï–ù–¢–´ UI ---
            const Button = ({ children, primary, className = "", onClick, icon: Icon }) => (
                <button 
                    onClick={onClick}
                    className={`
                        relative overflow-hidden group px-6 py-3 rounded-xl font-semibold transition-all duration-300 transform hover:-translate-y-1 hover:shadow-lg flex items-center gap-2
                        ${primary 
                            ? 'bg-gradient-to-r from-emerald-500 to-teal-400 text-white shadow-emerald-500/30' 
                            : 'bg-white/80 dark:bg-slate-800/80 backdrop-blur-md text-slate-700 dark:text-slate-200 border border-white/50 dark:border-slate-700/50 hover:bg-white dark:hover:bg-slate-700'}
                        ${className}
                    `}
                >
                    <div className="absolute inset-0 w-full h-full bg-white/20 translate-y-full group-hover:translate-y-0 transition-transform duration-300 pointer-events-none"></div>
                    {Icon && <Icon size={18} />}
                    {children}
                </button>
            );

            const GlassCard = ({ children, className = "", hoverEffect = true, animateIn = false, onClick, style }) => (
                <div 
                    onClick={onClick}
                    style={style}
                    className={`
                        backdrop-blur-xl bg-white/60 dark:bg-slate-800/50 border border-white/60 dark:border-slate-700/50 rounded-2xl p-6 shadow-[0_8px_30px_rgb(0,0,0,0.04)]
                        text-slate-800 dark:text-slate-100
                        ${hoverEffect ? 'transition-all duration-300 hover:shadow-[0_8px_30px_rgba(16,185,129,0.15)] hover:bg-white/80 dark:hover:bg-slate-800/80 hover:-translate-y-2' : ''}
                        ${animateIn ? 'animate-in fade-in slide-in-from-bottom-4 duration-700 fill-mode-backwards' : ''}
                        ${className}
                        ${animateIn ? 'gsap-card' : ''} 
                    `}
                >
                    {children}
                </div>
            );

            const Badge = ({ children }) => (
                <span className="inline-block px-3 py-1 rounded-full text-xs font-bold bg-emerald-100 text-emerald-700 border border-emerald-200 dark:bg-emerald-900/30 dark:text-emerald-400 dark:border-emerald-800 mb-2">
                    {children}
                </span>
            );

            // --- NOTICE MODAL: –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ –±–ª–æ–∫–æ–≤ –∏–∑ aida.smit34.ru/modal-config ---
            function renderNoticeBlocks(blocks) {
                if (!blocks || !blocks.length) return null;
                return blocks.map(function(block, i) {
                    switch (block.type) {
                        case 'paragraph':
                            return React.createElement('p', { key: i, className: 'text-slate-600 dark:text-slate-300 text-sm', dangerouslySetInnerHTML: { __html: block.text } });
                        case 'heading':
                            return React.createElement('div', { key: i, className: 'border-l-4 border-emerald-500 pl-3 py-1 bg-emerald-50/50 dark:bg-emerald-900/20 rounded-r-lg' },
                                React.createElement('h5', { className: 'font-bold text-slate-800 dark:text-slate-100 text-sm mb-1 uppercase tracking-wide', dangerouslySetInnerHTML: { __html: block.text } })
                            );
                        case 'separator':
                            return React.createElement('hr', { key: i, className: 'border-slate-200 dark:border-slate-700 my-4' });
                        case 'list':
                            return React.createElement('ul', { key: i, className: 'list-disc list-inside text-slate-600 dark:text-slate-300 text-sm space-y-1' },
                                (block.items || []).map(function(item, j) {
                                    return React.createElement('li', { key: j, dangerouslySetInnerHTML: { __html: item } });
                                })
                            );
                        case 'html':
                            return React.createElement('div', { key: i, dangerouslySetInnerHTML: { __html: block.html } });
                        case 'footer':
                            return React.createElement('p', { key: i, className: 'text-center text-slate-400 dark:text-slate-500 text-xs italic mt-6', dangerouslySetInnerHTML: { __html: block.text } });
                        default:
                            return null;
                    }
                });
            }

            // --- –ì–û–õ–û–°–û–í–û–ô AI –ê–°–°–ò–°–¢–ï–ù–¢ ---
            const GEMINI_API_KEY = 'AIzaSyDlnPbUWTe-ZVYiaTrZ7zayE7QMP4-Dha4';

            // Audio Utils
            function floatTo16BitPCM(input) {
                const output = new Int16Array(input.length);
                for (let i = 0; i < input.length; i++) {
                    const s = Math.max(-1, Math.min(1, input[i]));
                    output[i] = s < 0 ? s * 0x8000 : s * 0x7FFF;
                }
                return new Uint8Array(output.buffer);
            }

            function base64Encode(bytes) {
                let binary = '';
                for (let i = 0; i < bytes.byteLength; i++) {
                    binary += String.fromCharCode(bytes[i]);
                }
                return btoa(binary);
            }

            function base64Decode(base64) {
                const binaryString = atob(base64);
                const bytes = new Uint8Array(binaryString.length);
                for (let i = 0; i < binaryString.length; i++) {
                    bytes[i] = binaryString.charCodeAt(i);
                }
                return bytes;
            }

            async function decodeAudioData(data, ctx, sampleRate = 24000, numChannels = 1) {
                const dataInt16 = new Int16Array(data.buffer);
                const frameCount = dataInt16.length / numChannels;
                const buffer = ctx.createBuffer(numChannels, frameCount, sampleRate);
                for (let channel = 0; channel < numChannels; channel++) {
                    const channelData = buffer.getChannelData(channel);
                    for (let i = 0; i < frameCount; i++) {
                        channelData[i] = dataInt16[i * numChannels + channel] / 32768.0;
                    }
                }
                return buffer;
            }

            const INITIAL_SUGGESTIONS = [
                '–•–æ—á—É –ø–æ–¥–∫–ª—é—á–∏—Ç—å –∏–Ω—Ç–µ—Ä–Ω–µ—Ç üåê',
                '–ö–∞–∫–∏–µ —Ç–∞—Ä–∏—Ñ—ã –µ—Å—Ç—å? üìã',
                '–£–∂–µ –∫–ª–∏–µ–Ω—Ç, –µ—Å—Ç—å –ø—Ä–æ–±–ª–µ–º–∞ üîß',
                '–¶–µ–Ω–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è üí∞',
            ];

            function AIWidget() {
                // Chat state
                const [isOpen, setIsOpen] = useState(false);
                const [mode, setMode] = useState('chat');
                const [messages, setMessages] = useState([{role:'bot', text:'–ü—Ä–∏–≤–µ—Ç! –Ø AIDA ‚Äî –≤–∞—à AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç SmIT. –ü–æ–º–æ–≥—É –≤—ã–±—Ä–∞—Ç—å —Ç–∞—Ä–∏—Ñ, —Ä–∞—Å—Å–∫–∞–∂—É –æ–± —É—Å–ª—É–≥–∞—Ö –∏–ª–∏ –æ—Ñ–æ—Ä–º–ª—é –∑–∞—è–≤–∫—É –Ω–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ. –ß–µ–º –º–æ–≥—É –ø–æ–º–æ—á—å?'}]);
                const [input, setInput] = useState('');
                const [isLoading, setIsLoading] = useState(false);
                const [suggestions, setSuggestions] = useState(INITIAL_SUGGESTIONS);
                const messagesEndRef = useRef(null);
                const [sessionId] = useState(() => {
                    const stored = localStorage.getItem('smit_session_id');
                    if (stored) return stored;
                    const id = `widget_${Date.now()}_${Math.random().toString(36).slice(2,8)}`;
                    localStorage.setItem('smit_session_id', id);
                    return id;
                });

                // Voice state
                const [isActive, setIsActive] = useState(false);
                const [status, setStatus] = useState('idle');
                const [isAgentSpeaking, setIsAgentSpeaking] = useState(false);
                const [error, setError] = useState(null);

                const audioContextRef = useRef(null);
                const inputContextRef = useRef(null);
                const nextStartTimeRef = useRef(0);
                const sourcesRef = useRef(new Set());
                const processorRef = useRef(null);
                const streamRef = useRef(null);
                const sessionRef = useRef(null);
                const activeConnectionIdRef = useRef(null);
                const shouldReconnectRef = useRef(false);
                const reconnectAttemptsRef = useRef(0);
                const reconnectTimeoutRef = useRef(null);
                const voiceTranscriptRef = useRef([]);       // [{role, text}] ‚Äî –ø–æ–ª–Ω—ã–π —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ç —Å–µ—Å—Å–∏–∏
                const voiceCurrentBotRef = useRef('');       // —Ç–µ–∫—Å—Ç —Ç–µ–∫—É—â–µ–π —Ä–µ–ø–ª–∏–∫–∏ –±–æ—Ç–∞ (–Ω–∞–∫–∞–ø–ª–∏–≤–∞–µ—Ç—Å—è)
                const userInputAccumulatorRef = useRef('');  // –Ω–∞–∫–∞–ø–ª–∏–≤–∞–µ—Ç —Å–ª–æ–≤–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –æ–¥–Ω–æ–º –ø—É–∑—ã—Ä—å–∫–µ

                const cleanupResources = () => {
                    activeConnectionIdRef.current = null;
                    if (processorRef.current) { processorRef.current.disconnect(); processorRef.current = null; }
                    if (streamRef.current) { streamRef.current.getTracks().forEach(t => t.stop()); streamRef.current = null; }
                    if (inputContextRef.current) { inputContextRef.current.close(); inputContextRef.current = null; }
                    if (audioContextRef.current) { audioContextRef.current.close(); audioContextRef.current = null; }
                    if (sessionRef.current) { sessionRef.current = null; }
                    sourcesRef.current.forEach(s => s.stop());
                    sourcesRef.current.clear();
                    setIsAgentSpeaking(false);
                    nextStartTimeRef.current = 0;
                };

                const stop = () => {
                    shouldReconnectRef.current = false;
                    reconnectAttemptsRef.current = 0;
                    if (reconnectTimeoutRef.current) clearTimeout(reconnectTimeoutRef.current);

                    // Relay –≤ AIDA –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ª–∏–¥–∞ ‚Äî –ø–æ—à–∞–≥–æ–≤—ã–π –¥–∏–∞–ª–æ–≥
                    const transcript = voiceTranscriptRef.current;
                    if (transcript.length > 0) {
                        const botMsgs = transcript.filter(m => m.role === 'bot');
                        const confirmMsg = botMsgs.slice().reverse().find(m => {
                            const t = m.text.toLowerCase();
                            return (t.includes('–≤–µ—Ä–Ω') || t.includes('–¥–∞–Ω–Ω—ã–µ') || t.includes('–ø–æ–≤—Ç–æ—Ä')) &&
                                   (t.includes('—Ç–∞—Ä–∏—Ñ') || t.includes('–Ω–æ–º–µ—Ä') || t.includes('—Ç–µ–ª–µ—Ñ–æ–Ω') || t.includes('–∞–¥—Ä–µ—Å') || t.includes('–∏–º—è'));
                        }) || (botMsgs.length >= 2 ? botMsgs[botMsgs.length - 2] : botMsgs[botMsgs.length - 1]);

                        if (confirmMsg) {
                            const raw = confirmMsg.text.replace(/\s+/g, ' ').trim();

                            const nameM  = raw.match(/–ò–º—è:\s*([–ê-–Ø–Å–∞-—è—ë][–∞-—è—ë]+)/i)
                                        || raw.match(/(?:–∑–æ–≤—É—Ç\s*|–∑–∞—è–≤–∫–∏:\s*)([–ê-–Ø–Å–∞-—è—ë][–∞-—è—ë]+)/i)
                                        || raw.match(/(?:\d[\d\s\-]+,\s*)([–ê-–Ø–Å–∞-—è—ë][–∞-—è—ë]{2,})/i);
                            // –¢–µ–ª–µ—Ñ–æ–Ω: —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –†–§ —Ñ–æ—Ä–º–∞—Ç —Å/–±–µ–∑ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª–µ–π (8xxxxxxxxxx –∏–ª–∏ 8 xxx xxx xx xx)
                            const phoneM = raw.match(/–¢–µ–ª–µ—Ñ–æ–Ω:\s*(\+?[\d][\d\s\-\(\)]{8,14})/i)
                                        || raw.match(/(\+?[78][\s\-]?\(?\d{3}\)?[\s\-]?\d{3}[\s\-]?\d{2}[\s\-]?\d{2})/);
                            const addrM  = raw.match(/–ê–¥—Ä–µ—Å:\s*(.+?)(?:,\s*(?:–¢–∞—Ä–∏—Ñ|–¢–µ–ª–µ—Ñ–æ–Ω|–ò–º—è)|$)/i)
                                        || raw.match(/–∞–¥—Ä–µ—Å[:\s]+(.+?)(?:,?\s*(?:—Ç–∞—Ä–∏—Ñ|—Ç–µ–ª–µ—Ñ–æ–Ω|–Ω–æ–º–µ—Ä|–≤—Å—ë|–≤—Å–µ|–ø–æ–¥—Ç–≤–µ—Ä–∂))/i);
                            const tariffM = raw.match(/–¢–∞—Ä–∏—Ñ:\s*[¬´"]?([^¬ª".,\n]+)/i)
                                        || raw.match(/¬´([^¬ª]+)¬ª/);

                            const name   = nameM   ? nameM[1].trim()   : '';
                            const phone  = phoneM  ? phoneM[1].trim()  : '';
                            const addr   = addrM   ? addrM[1].trim()   : '';
                            const tariff = tariffM ? tariffM[1].trim() : '';

                            console.log('[AIDA relay] parsed:', { name, phone, addr, tariff });

                            // –£–º–Ω—ã–π relay ‚Äî –æ—Ç–≤–µ—á–∞–µ—Ç –ø–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É –æ—Ç–≤–µ—Ç–æ–≤ AIDA
                            const relaySessionId = `widget_${Date.now()}_${Math.random().toString(36).slice(2,8)}`;
                            const runRelay = async () => {
                                const post = async (msg) => {
                                    const r = await fetch('https://aida.smit34.ru/chat', {
                                        method: 'POST',
                                        headers: { 'Content-Type': 'application/json' },
                                        body: JSON.stringify({ session_id: relaySessionId, message: msg })
                                    });
                                    return (await r.json()).response || '';
                                };

                                // –§–ª–∞–≥–∏ —á—Ç–æ —É–∂–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –≤ —ç—Ç–æ–π —Å–µ—Å—Å–∏–∏
                                let sentName = false, sentPhone = false, sentAddr = false, sentTariff = false;

                                const nextMsg = (resp) => {
                                    const r = resp.toLowerCase();
                                    // –°—Ç–æ–ø –¢–û–õ–¨–ö–û –µ—Å–ª–∏ —Ç–µ–ª–µ—Ñ–æ–Ω —É–∂–µ –±—ã–ª –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω
                                    if (sentPhone && (r.includes('–ø—Ä–∏–Ω—è—Ç') || r.includes('—Å–æ–∑–¥–∞–Ω') || r.includes('–∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä'))) return null;
                                    // –ò–º—è + —Ç–µ–ª–µ—Ñ–æ–Ω ‚Äî –∫–æ–º–±–∏–Ω–∏—Ä—É–µ–º —á—Ç–æ–±—ã —Ç–µ–ª–µ—Ñ–æ–Ω –Ω–µ –ø–æ—Ç–µ—Ä—è–ª—Å—è
                                    if (!sentName && (r.includes('–∑–æ–≤—É—Ç') || r.includes('–æ–±—Ä–∞—â–∞—Ç—å—Å—è') || r.includes('–≤–∞—à–µ –∏–º—è'))) {
                                        sentName = true; sentPhone = true;
                                        return phone ? `${name || '–ö–ª–∏–µ–Ω—Ç'}. –ú–æ–π —Ç–µ–ª–µ—Ñ–æ–Ω: ${phone}` : (name || '–ö–ª–∏–µ–Ω—Ç');
                                    }
                                    // –¢–µ–ª–µ—Ñ–æ–Ω ‚Äî –µ—Å–ª–∏ AIDA –æ—Ç–¥–µ–ª—å–Ω–æ —Å–ø—Ä–∞—à–∏–≤–∞–µ—Ç
                                    if (!sentPhone && (r.includes('—Ç–µ–ª–µ—Ñ–æ–Ω') || r.includes('–Ω–æ–º–µ—Ä'))) {
                                        sentPhone = true; return phone || '';
                                    }
                                    // –ê–¥—Ä–µ—Å
                                    if (!sentAddr && (r.includes('–∞–¥—Ä–µ—Å') || r.includes('–ø—Ä–æ–∂–∏–≤–∞–µ—Ç–µ') || (r.includes('–≥–¥–µ') && r.includes('–ø–æ–¥–∫–ª—é—á')))) {
                                        sentAddr = true; return addr || '–í–æ–ª–≥–æ–≥—Ä–∞–¥';
                                    }
                                    // –¢–∞—Ä–∏—Ñ / –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞
                                    if (!sentTariff && (r.includes('—Ç–∞—Ä–∏—Ñ') || r.includes('–∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ') || r.includes('–∑–∞–¥–∞—á–∏') || r.includes('–Ω—É–∂–µ–Ω –∏–Ω—Ç–µ—Ä–Ω–µ—Ç'))) {
                                        sentTariff = true; return tariff ? `–•–æ—á—É —Ç–∞—Ä–∏—Ñ ¬´${tariff}¬ª` : '–°–∞–º—ã–π –ø–æ–ø—É–ª—è—Ä–Ω—ã–π';
                                    }
                                    if (r.includes('–≤—Ä–µ–º—è') || r.includes('—É–¥–æ–±–Ω–æ') || r.includes('–∫–æ–≥–¥–∞')) {
                                        return '–í –ª—é–±–æ–µ —Ä–∞–±–æ—á–µ–µ –≤—Ä–µ–º—è';
                                    }
                                    if (r.includes('–≤–µ—Ä–Ω–æ') || r.includes('–ø—Ä–∞–≤–∏–ª—å–Ω') || r.includes('–¥–∞–Ω–Ω—ã–µ')) {
                                        return '–î–∞, –≤—Å—ë –≤–µ—Ä–Ω–æ';
                                    }
                                    // –ê–¥—Ä–µ—Å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω ‚Äî —è–≤–Ω–æ –ø—Ä–æ—Å–∏–º –æ—Ñ–æ—Ä–º–∏—Ç—å –∑–∞—è–≤–∫—É
                                    if (sentAddr && sentPhone && (r.includes('–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è') || r.includes('–¥–æ—Å—Ç—É–ø–Ω–æ') || r.includes('–ø–æ–¥–∫–ª—é—á–∏–º'))) {
                                        return '–û—Ç–ª–∏—á–Ω–æ! –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –æ—Ñ–æ—Ä–º–∏—Ç–µ –∑–∞—è–≤–∫—É –Ω–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞.';
                                    }
                                    // –î–æ–ø—Ä–æ–¥–∞–∂–∏ ‚Äî –æ—Ç–∫–ª–æ–Ω—è–µ–º –∏ –ø—Ä–æ—Å–∏–º –∑–∞—è–≤–∫—É
                                    if (r.includes('—Ä–æ—É—Ç–µ—Ä') || r.includes('wi-fi') || r.includes('wifi') ||
                                        r.includes('–≤–∏–¥–µ–æ–Ω–∞–±–ª—é–¥–µ–Ω–∏') || r.includes('–∫–∞–º–µ—Ä') ||
                                        r.includes('–ø–æ—Å—Ç–æ—è–Ω–Ω—ã–π ip') || r.includes('ip-–∞–¥—Ä–µ—Å') ||
                                        r.includes('–ø—Ä–µ–¥–ª–∞–≥–∞—é –≤–∞–º –æ–ø—Ü–∏—é') || r.includes('–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω')) {
                                        return '–ù–µ—Ç, —Å–ø–∞—Å–∏–±–æ. –û—Ñ–æ—Ä–º–∏—Ç–µ —Ç–æ–ª—å–∫–æ –∑–∞—è–≤–∫—É –Ω–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞.';
                                    }
                                    // –°—Ç—Ä–∞—Ö–æ–≤–∫–∞: —Ç–µ–ª–µ—Ñ–æ–Ω –µ—â—ë –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω
                                    if (!sentPhone && phone) { sentPhone = true; return phone; }
                                    return '–î–∞, –æ—Ñ–æ—Ä–º–∏—Ç–µ –∑–∞—è–≤–∫—É –Ω–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ';
                                };

                                let resp = await post('–•–æ—á—É –ø–æ–¥–∫–ª—é—á–∏—Ç—å –∏–Ω—Ç–µ—Ä–Ω–µ—Ç');
                                console.log('[AIDA relay] r0 ‚Üí', resp.slice(0,100));

                                for (let t = 0; t < 14; t++) {
                                    const msg = nextMsg(resp);
                                    if (!msg) { console.log('[AIDA relay] done ‚úì'); break; }
                                    resp = await post(msg);
                                    console.log(`[AIDA relay] r${t+1} (${msg.slice(0,25)}) ‚Üí`, resp.slice(0,100));
                                }
                            };
                            runRelay().catch(e => console.error('[AIDA relay] error:', e));
                        }
                    }

                    // –°–±—Ä–æ—Å–∏—Ç—å –Ω–∞–∫–æ–ø–∏—Ç–µ–ª–∏
                    const hadConversation = transcript.length > 0;
                    voiceTranscriptRef.current = [];
                    voiceCurrentBotRef.current = '';
                    userInputAccumulatorRef.current = '';

                    // –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –≤ —á–∞—Ç –µ—Å–ª–∏ –±—ã–ª —Ä–∞–∑–≥–æ–≤–æ—Ä
                    if (hadConversation) {
                        setMode('chat');
                        setMessages(prev => [...prev, {
                            role: 'bot',
                            text: '–ì–æ–ª–æ—Å–æ–≤–æ–π —Ä–∞–∑–≥–æ–≤–æ—Ä –∑–∞–≤–µ—Ä—à—ë–Ω. –ï—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å –∏–ª–∏ —É—Ç–æ—á–Ω–∏—Ç—å –¥–µ—Ç–∞–ª–∏ ‚Äî –Ω–∞–ø–∏—à–∏—Ç–µ –º–Ω–µ!'
                        }]);
                        setSuggestions(['–û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞—è–≤–∫—É üìù', '–£—Ç–æ—á–Ω–∏—Ç—å —Ç–∞—Ä–∏—Ñ üìã', '–ü–æ–∑–≤–æ–Ω–∏—Ç—å —Å–µ–π—á–∞—Å üìû']);
                    }

                    cleanupResources();
                    setIsActive(false);
                    setStatus('idle');
                };

                const connect = async () => {
                    // –ñ–¥—ë–º –∑–∞–≥—Ä—É–∑–∫–∏ SDK (–¥–æ 5 —Å–µ–∫—É–Ω–¥)
                    let attempts = 0;
                    while (!window.GoogleGenAI && attempts < 50) {
                        await new Promise(r => setTimeout(r, 100));
                        attempts++;
                    }

                    if (!window.GoogleGenAI) {
                        setError('SDK –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω. –û–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É.');
                        setStatus('error');
                        return;
                    }

                    if (reconnectTimeoutRef.current) clearTimeout(reconnectTimeoutRef.current);
                    const connectionId = Date.now().toString();
                    activeConnectionIdRef.current = connectionId;

                    setStatus('connecting');
                    setIsActive(true);
                    setError(null);
                    shouldReconnectRef.current = false; // –û—Ç–∫–ª—é—á–∞–µ–º –∞–≤—Ç–æ-—Ä–µ–∫–æ–Ω–Ω–µ–∫—Ç

                    try {
                        const AudioContextClass = window.AudioContext || window.webkitAudioContext;
                        audioContextRef.current = new AudioContextClass({ sampleRate: 24000 });
                        inputContextRef.current = new AudioContextClass({ sampleRate: 16000 });

                        const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
                        streamRef.current = stream;
                        if (activeConnectionIdRef.current !== connectionId) return;

                        const ai = new window.GoogleGenAI({ apiKey: GEMINI_API_KEY });

                        const config = {
                            model: 'gemini-2.5-flash-native-audio-preview-12-2025',
                            config: {
                                responseModalities: [window.GeminiModality.AUDIO],
                                speechConfig: {
                                    voiceConfig: { prebuiltVoiceConfig: { voiceName: 'Zephyr' } },
                                },
                                inputAudioTranscription: {},
                                outputAudioTranscription: {},
                                systemInstruction: `–¢—ã ‚Äî AIDA, –≥–æ–ª–æ—Å–æ–≤–æ–π AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-–ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ –°–ú–ò–¢ (Smit34.ru) –≤ –í–æ–ª–≥–æ–≥—Ä–∞–¥—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏.

–¢–í–û–Ø –ó–ê–î–ê–ß–ê: –ø–æ–º–æ–≥–∞—Ç—å –∫–ª–∏–µ–Ω—Ç–∞–º —Å –≤—ã–±–æ—Ä–æ–º —Ç–∞—Ä–∏—Ñ–∞, –∫–æ–Ω—Å—É–ª—å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ —É—Å–ª—É–≥–∞–º, –æ—Ç–≤–µ—á–∞—Ç—å –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã.

–¢–ê–†–ò–§–´ (–ò–°–ü–û–õ–¨–ó–£–ô –¢–û–õ–¨–ö–û –≠–¢–ò!):
- ¬´–≠—Ç–æ –ø—Ä–æ—Å—Ç–æ¬ª ‚Äî 25 –ú–±–∏—Ç/—Å, 869 —Ä—É–±–ª–µ–π –≤ –º–µ—Å—è—Ü
- ¬´–î–ª—è —Ç–µ–±—è¬ª ‚Äî 40 –ú–±–∏—Ç/—Å, 749 —Ä—É–±–ª–µ–π –≤ –º–µ—Å—è—Ü
- ¬´Smit¬ª ‚Äî 100 –ú–±–∏—Ç/—Å, 949 —Ä—É–±–ª–µ–π –≤ –º–µ—Å—è—Ü (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π)
- ¬´–ë–µ–∑ –≥—Ä–∞–Ω–∏—Ü¬ª ‚Äî 150 –ú–±–∏—Ç/—Å, 1199 —Ä—É–±–ª–µ–π –≤ –º–µ—Å—è—Ü

–ü–û–î–ö–õ–Æ–ß–ï–ù–ò–ï: 10 000 —Ä—É–±–ª–µ–π (–µ–¥–∏–Ω–æ—Ä–∞–∑–æ–≤–æ). –†–æ—É—Ç–µ—Ä –ø–æ–∫—É–ø–∞–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ.

–î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –£–°–õ–£–ì–ò:
- –í–∏–¥–µ–æ–Ω–∞–±–ª—é–¥–µ–Ω–∏–µ: –æ—Ç 1 –∫–∞–º–µ—Ä—ã
- –ü–æ—Å—Ç–æ—è–Ω–Ω—ã–π IP: 150 —Ä—É–±–ª–µ–π –≤ –º–µ—Å—è—Ü

–ö–û–ù–¢–ê–ö–¢–´:
- –¢–µ–ª–µ—Ñ–æ–Ω –ø–æ–¥–¥–µ—Ä–∂–∫–∏: 55-35-59
- –°–∞–π—Ç: smit34.ru
- Telegram: @smitsupport_bot

–ü–†–ê–í–ò–õ–ê –û–ë–©–ï–ù–ò–Ø:
- –ì–æ–≤–æ—Ä–∏ –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ
- –ë—É–¥—å –¥—Ä—É–∂–µ–ª—é–±–Ω—ã–º –∏ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–º
- –û—Ç–≤–µ—á–∞–π –∫—Ä–∞—Ç–∫–æ –∏ –ø–æ –¥–µ–ª—É
- –°–Ω–∞—á–∞–ª–∞ —É–∑–Ω–∞–π –∏–º—è –∫–ª–∏–µ–Ω—Ç–∞ –∏ –µ–≥–æ –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–∏
- –†–µ–∫–æ–º–µ–Ω–¥—É–π –ø–æ–¥—Ö–æ–¥—è—â–∏–π —Ç–∞—Ä–∏—Ñ –∏—Å—Ö–æ–¥—è –∏–∑ –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–µ–π
- –ï—Å–ª–∏ –∫–ª–∏–µ–Ω—Ç —Ö–æ—á–µ—Ç –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è ‚Äî –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —É–∑–Ω–∞–π: –∏–º—è, –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞, –∞–¥—Ä–µ—Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
- –ü–æ–¥—Ç–≤–µ—Ä–¥–∏ –¥–µ—Ç–∞–ª–∏ –∑–∞—è–≤–∫–∏ –≥–æ–ª–æ—Å–æ–º –°–¢–†–û–ì–û –≤ —Ñ–æ—Ä–º–∞—Ç–µ: "–ò–º—è: [–∏–º—è], –¢–µ–ª–µ—Ñ–æ–Ω: [—Ç–µ–ª–µ—Ñ–æ–Ω], –ê–¥—Ä–µ—Å: [–∞–¥—Ä–µ—Å], –¢–∞—Ä–∏—Ñ: ¬´[—Ç–∞—Ä–∏—Ñ]¬ª. –í—Å—ë –≤–µ—Ä–Ω–æ?"`,
                            },
                        };

                        let sessionPromise;

                        const handleConnectionDrop = (errorMsg) => {
                            if (activeConnectionIdRef.current !== connectionId && activeConnectionIdRef.current !== null) return;
                            cleanupResources();
                            setStatus('error');
                            setError(errorMsg || '–°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –ø—Ä–µ—Ä–≤–∞–Ω–æ');
                            setIsActive(false);
                        };

                        const callbacks = {
                            onopen: () => {
                                if (activeConnectionIdRef.current !== connectionId) return;
                                reconnectAttemptsRef.current = 0;
                                setStatus('connected');
                                if (!inputContextRef.current || !streamRef.current) return;

                                const source = inputContextRef.current.createMediaStreamSource(streamRef.current);
                                const processor = inputContextRef.current.createScriptProcessor(4096, 1, 1);
                                processorRef.current = processor;

                                processor.onaudioprocess = (e) => {
                                    if (activeConnectionIdRef.current !== connectionId) return;
                                    const inputData = e.inputBuffer.getChannelData(0);
                                    const pcmData = floatTo16BitPCM(inputData);
                                    const base64Data = base64Encode(pcmData);
                                    sessionPromise.then(session => {
                                        if (activeConnectionIdRef.current !== connectionId) return;
                                        try {
                                            session.sendRealtimeInput({ media: { mimeType: 'audio/pcm;rate=16000', data: base64Data } });
                                        } catch (err) {}
                                    });
                                };

                                source.connect(processor);
                                processor.connect(inputContextRef.current.destination);
                            },
                            onmessage: async (message) => {
                                if (activeConnectionIdRef.current !== connectionId) return;
                                if (message.serverContent?.interrupted) {
                                    sourcesRef.current.forEach(s => { s.stop(); sourcesRef.current.delete(s); });
                                    nextStartTimeRef.current = 0;
                                    setIsAgentSpeaking(false);
                                    return;
                                }

                                // User speech ‚Üí –Ω–∞–∫–∞–ø–ª–∏–≤–∞–µ–º —Ñ—Ä–∞–≥–º–µ–Ω—Ç—ã –≤ –û–î–ò–ù –ø—É–∑—ã—Ä—ë–∫
                                const inputText = message.serverContent?.inputTranscription?.text;
                                if (inputText?.trim()) {
                                    userInputAccumulatorRef.current += (userInputAccumulatorRef.current ? ' ' : '') + inputText.trim();
                                    const accText = userInputAccumulatorRef.current;
                                    setMessages(prev => {
                                        const last = prev[prev.length - 1];
                                        if (last && last.role === 'user' && last.text.startsWith('üé§')) {
                                            return [...prev.slice(0, -1), { role: 'user', text: `üé§ ${accText}` }];
                                        }
                                        return [...prev, { role: 'user', text: `üé§ ${accText}` }];
                                    });
                                }

                                // AI output transcription ‚Äî –Ω–∞–∫–∞–ø–ª–∏–≤–∞–µ–º –¥–æ turnComplete
                                const outputText = message.serverContent?.outputTranscription?.text;
                                if (outputText?.trim()) {
                                    voiceCurrentBotRef.current += outputText;
                                }

                                // On turn complete ‚Äî —Ñ–∏–∫—Å–∏—Ä—É–µ–º —Ä–µ–ø–ª–∏–∫–∏ –≤ transcript (–±–µ–∑ relay)
                                if (message.serverContent?.turnComplete) {
                                    if (userInputAccumulatorRef.current) {
                                        const userText = userInputAccumulatorRef.current;
                                        voiceTranscriptRef.current.push({ role: 'user', text: userText });
                                        userInputAccumulatorRef.current = '';
                                    }
                                    if (voiceCurrentBotRef.current.trim()) {
                                        const botText = voiceCurrentBotRef.current.trim();
                                        voiceTranscriptRef.current.push({ role: 'bot', text: botText });
                                        setMessages(prev => [...prev, { role: 'bot', text: `üîä ${botText}` }]);
                                        voiceCurrentBotRef.current = '';
                                    }
                                }

                                // Play audio as before
                                const base64Audio = message.serverContent?.modelTurn?.parts?.find(p => p.inlineData)?.inlineData?.data;
                                if (base64Audio && audioContextRef.current) {
                                    setIsAgentSpeaking(true);
                                    const audioCtx = audioContextRef.current;
                                    const startTime = Math.max(nextStartTimeRef.current, audioCtx.currentTime);
                                    nextStartTimeRef.current = startTime;
                                    const pcmData = base64Decode(base64Audio);
                                    const audioBuffer = await decodeAudioData(pcmData, audioCtx, 24000, 1);
                                    const source = audioCtx.createBufferSource();
                                    source.buffer = audioBuffer;
                                    source.connect(audioCtx.destination);
                                    source.onended = () => {
                                        sourcesRef.current.delete(source);
                                        if (sourcesRef.current.size === 0) setIsAgentSpeaking(false);
                                    };
                                    source.start(startTime);
                                    nextStartTimeRef.current += audioBuffer.duration;
                                    sourcesRef.current.add(source);
                                }
                            },
                            onclose: (e) => {
                                console.warn('[Gemini] onclose', e);
                                handleConnectionDrop('–°–µ—Å—Å–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞');
                            },
                            onerror: (e) => {
                                console.error('[Gemini] onerror', e);
                                const msg = e?.message || e?.code || JSON.stringify(e) || 'unknown';
                                handleConnectionDrop('–û—à–∏–±–∫–∞: ' + msg.slice(0, 80));
                            }
                        };

                        sessionPromise = ai.live.connect({ ...config, callbacks });
                        sessionPromise.then(session => {
                            if (activeConnectionIdRef.current === connectionId) {
                                sessionRef.current = session;
                                // –¢—Ä–∏–≥–≥–µ—Ä ‚Äî AI –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ø–µ—Ä–≤—ã–º
                                try {
                                    session.sendClientContent({
                                        turns: [{ role: 'user', parts: [{ text: '[–ù–ê–ß–ê–õ–û –°–ï–°–°–ò–ò] –ü–æ–∑–¥–æ—Ä–æ–≤–∞–π—Å—è —Å –∫–ª–∏–µ–Ω—Ç–æ–º –∏ —Å–ø—Ä–æ—Å–∏ —á–µ–º –º–æ–∂–µ—à—å –ø–æ–º–æ—á—å.' }] }],
                                        turnComplete: true
                                    });
                                } catch(e) {}
                            }
                        }).catch(e => {
                            const msg = e?.message || e?.statusText || String(e);
                            console.error('[Gemini] connect error:', msg, e);
                            handleConnectionDrop('–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è: ' + msg.slice(0, 80));
                        });

                    } catch (err) {
                        console.error('Failed to connect:', err);
                        cleanupResources();
                        setIsActive(false);
                        setStatus('error');
                        setError(err.name === 'NotAllowedError' ? '–ù–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ –º–∏–∫—Ä–æ—Ñ–æ–Ω—É' : '–û—à–∏–±–∫–∞: ' + err.message);
                    }
                };

                useEffect(() => {
                    return () => { shouldReconnectRef.current = false; cleanupResources(); };
                }, []);

                // Pending message ref ‚Äî used when widget is opened with a preset message
                const pendingMessageRef = useRef(null);

                // Expose open function globally (accepts optional message)
                useEffect(() => {
                    window.openAIWidget = (message) => {
                        setIsOpen(true);
                        setMode('chat');
                        if (message) pendingMessageRef.current = message;
                    };
                    return () => { delete window.openAIWidget; };
                }, []);

                // Send pending message once widget is open and not loading
                useEffect(() => {
                    if (isOpen && pendingMessageRef.current && !isLoading) {
                        const msg = pendingMessageRef.current;
                        pendingMessageRef.current = null;
                        sendMessage(msg);
                    }
                }, [isOpen]);

                // Auto-scroll to latest message
                useEffect(() => {
                    if (messagesEndRef.current) messagesEndRef.current.scrollIntoView({ behavior: 'smooth' });
                }, [messages, isLoading]);

                // Parse suggestion buttons from backend response
                const parseResponse = (text) => {
                    const buttons = [];
                    const cleanText = text.replace(/üí°[^\n]*/g, (match) => {
                        const found = [...match.matchAll(/"([^"]+)"/g)].map(m => m[1]);
                        buttons.push(...found);
                        return '';
                    }).trim();
                    return { cleanText, buttons };
                };

                // Send chat message to backend
                const sendMessage = async (text) => {
                    if (!text.trim() || isLoading) return;
                    setMessages(prev => [...prev, { role: 'user', text }]);
                    setInput('');
                    setIsLoading(true);
                    setSuggestions([]);
                    try {
                        const res = await fetch('https://aida.smit34.ru/chat', {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({ session_id: sessionId, message: text })
                        });
                        const data = await res.json();
                        const { cleanText, buttons } = parseResponse(data.response);
                        setMessages(prev => [...prev, { role: 'bot', text: cleanText }]);
                        setSuggestions(buttons.length > 0 ? buttons : []);
                    } catch {
                        setMessages(prev => [...prev, { role: 'bot', text: '–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑.' }]);
                    } finally {
                        setIsLoading(false);
                    }
                };

                // Microphone dictation for chat input
                const startDictation = () => {
                    const SR = window.SpeechRecognition || window.webkitSpeechRecognition;
                    if (!SR) return;
                    const rec = new SR();
                    rec.lang = 'ru-RU';
                    rec.onresult = e => setInput(e.results[0][0].transcript);
                    rec.start();
                };

                return (
                    <div className="ai-widget-outer fixed bottom-6 right-6 z-[50] flex flex-col items-end pointer-events-none">
                        {/* Widget Panel */}
                        <div className={`pointer-events-auto mb-4 backdrop-blur-xl bg-white/80 dark:bg-slate-900/85 border border-white/30 dark:border-slate-700/50 shadow-[0_20px_60px_rgba(16,185,129,0.25)] overflow-hidden transition-all duration-500 flex flex-col w-80 sm:w-96 rounded-3xl origin-bottom-right
                            ${isOpen ? 'opacity-100 scale-100 translate-y-0 ai-widget-open' : 'opacity-0 scale-90 translate-y-10 pointer-events-none'}`}
                            style={{ height: isOpen ? '580px' : '0' }}
                            id="ai-widget-panel">

                            {/* Header */}
                            <div className="bg-emerald-600/90 dark:bg-emerald-800/90 text-white px-4 py-3 flex items-center justify-between flex-shrink-0">
                                <div className="flex items-center gap-3">
                                    <div className="w-9 h-9 rounded-full bg-white/20 flex items-center justify-center">
                                        <Bot size={18} />
                                    </div>
                                    <div>
                                        <p className="font-bold text-sm">AIDA</p>
                                        <div className="flex items-center gap-1.5">
                                            <div className="w-1.5 h-1.5 bg-emerald-300 rounded-full animate-pulse"></div>
                                            <p className="text-xs text-emerald-100">–æ–Ω–ª–∞–π–Ω</p>
                                        </div>
                                    </div>
                                </div>
                                <div className="flex items-center gap-2">
                                    <button onClick={() => setMode('voice')} title="–ì–æ–ª–æ—Å–æ–≤–æ–π —Ä–µ–∂–∏–º" className={`w-8 h-8 rounded-full flex items-center justify-center transition-colors ${mode === 'voice' ? 'bg-white/30' : 'bg-white/10 hover:bg-white/20'}`}>
                                        <Phone size={14} />
                                    </button>
                                    <button onClick={() => { if (mode === 'voice') stop(); setIsOpen(false); }} className="w-8 h-8 rounded-full bg-white/10 hover:bg-white/20 flex items-center justify-center transition-colors">
                                        <X size={16} />
                                    </button>
                                </div>
                            </div>

                            {/* Mode Tabs */}
                            <div className="flex border-b border-slate-200/50 dark:border-slate-700/50 flex-shrink-0 bg-white/50 dark:bg-slate-900/50">
                                <button onClick={() => setMode('chat')} className={`flex-1 py-2 text-xs font-semibold flex items-center justify-center gap-1.5 transition-colors ${mode === 'chat' ? 'text-emerald-600 dark:text-emerald-400 border-b-2 border-emerald-500 bg-emerald-50/50 dark:bg-emerald-900/20' : 'text-slate-500 hover:text-slate-700 dark:text-slate-400'}`}>
                                    <Bot size={13} /> –ß–∞—Ç
                                </button>
                                <button onClick={() => setMode('voice')} className={`flex-1 py-2 text-xs font-semibold flex items-center justify-center gap-1.5 transition-colors ${mode === 'voice' ? 'text-emerald-600 dark:text-emerald-400 border-b-2 border-emerald-500 bg-emerald-50/50 dark:bg-emerald-900/20' : 'text-slate-500 hover:text-slate-700 dark:text-slate-400'}`}>
                                    <Mic size={13} /> –ì–æ–ª–æ—Å
                                </button>
                            </div>

                            {/* Chat Mode */}
                            {mode === 'chat' && (
                                <>
                                    <div className="flex-1 overflow-y-auto p-4 space-y-3 min-h-0">
                                        {messages.map((msg, i) => (
                                            <div key={i} className={`flex ${msg.role === 'user' ? 'justify-end' : 'justify-start'}`}>
                                                <div className={`max-w-[82%] px-3.5 py-2.5 rounded-2xl text-sm leading-relaxed ${msg.role === 'user' ? 'bg-emerald-500 text-white rounded-br-sm' : 'bg-white/70 dark:bg-slate-800/70 border border-white/50 dark:border-slate-700/50 text-slate-800 dark:text-slate-200 rounded-bl-sm'}`}>
                                                    {msg.text}
                                                </div>
                                            </div>
                                        ))}
                                        {isLoading && (
                                            <div className="flex justify-start">
                                                <div className="bg-white/70 dark:bg-slate-800/70 border border-white/50 dark:border-slate-700/50 px-4 py-3 rounded-2xl rounded-bl-sm">
                                                    <div className="flex gap-1.5 items-center">
                                                        <div className="w-2 h-2 bg-emerald-500 rounded-full animate-bounce" style={{animationDelay:'0ms'}}></div>
                                                        <div className="w-2 h-2 bg-emerald-500 rounded-full animate-bounce" style={{animationDelay:'150ms'}}></div>
                                                        <div className="w-2 h-2 bg-emerald-500 rounded-full animate-bounce" style={{animationDelay:'300ms'}}></div>
                                                    </div>
                                                </div>
                                            </div>
                                        )}
                                        <div ref={messagesEndRef} />
                                    </div>

                                    {suggestions.length > 0 && (
                                        <div className="px-3 py-2 flex gap-2 overflow-x-auto flex-shrink-0 border-t border-slate-200/30 dark:border-slate-700/30" style={{scrollbarWidth:'none'}}>
                                            {suggestions.map((s, i) => (
                                                <button key={i} onClick={() => sendMessage(s)}
                                                    className="whitespace-nowrap text-xs px-3 py-1.5 rounded-full bg-white/60 dark:bg-slate-700/60 border border-emerald-200/50 dark:border-emerald-700/50 hover:bg-emerald-50 dark:hover:bg-emerald-900/30 text-slate-700 dark:text-slate-300 transition-colors flex-shrink-0">
                                                    {s}
                                                </button>
                                            ))}
                                        </div>
                                    )}

                                    <div className="px-3 py-3 border-t border-slate-200/50 dark:border-slate-700/50 flex gap-2 items-center flex-shrink-0 bg-white/50 dark:bg-slate-900/50">
                                        <input value={input} onChange={e => setInput(e.target.value)}
                                            onKeyDown={e => e.key === 'Enter' && sendMessage(input)}
                                            placeholder="–ó–∞–¥–∞–π—Ç–µ –≤–æ–ø—Ä–æ—Å..."
                                            className="flex-1 bg-white/80 dark:bg-slate-800/80 border border-slate-200/50 dark:border-slate-700/50 rounded-xl px-3.5 py-2 text-sm text-slate-900 dark:text-white placeholder-slate-400 outline-none focus:ring-2 focus:ring-emerald-500/30 focus:border-emerald-400 transition-all" />
                                        <button onClick={() => sendMessage(input)} disabled={!input.trim() || isLoading}
                                            className="w-9 h-9 rounded-xl bg-emerald-500 hover:bg-emerald-600 disabled:opacity-40 disabled:cursor-not-allowed flex items-center justify-center text-white transition-colors flex-shrink-0">
                                            <ArrowRight size={15} />
                                        </button>
                                    </div>
                                </>
                            )}

                            {/* Voice Mode */}
                            {mode === 'voice' && (
                                <div className="flex-1 flex flex-col min-h-0">
                                    {/* Live transcript ‚Äî same messages as chat */}
                                    {status === 'connected' || messages.some(m => m.text?.startsWith('üé§') || m.text?.startsWith('üîä')) ? (
                                        <div className="flex-1 overflow-y-auto p-4 space-y-3 min-h-0">
                                            {messages.filter(m => m.text?.startsWith('üé§') || m.text?.startsWith('üîä')).map((msg, i) => (
                                                <div key={i} className={`flex ${msg.role === 'user' ? 'justify-end' : 'justify-start'}`}>
                                                    <div className={`max-w-[82%] px-3.5 py-2.5 rounded-2xl text-sm leading-relaxed ${msg.role === 'user' ? 'bg-emerald-500 text-white rounded-br-sm' : 'bg-white/70 dark:bg-slate-800/70 border border-white/50 dark:border-slate-700/50 text-slate-800 dark:text-slate-200 rounded-bl-sm'}`}>
                                                        {msg.text}
                                                    </div>
                                                </div>
                                            ))}
                                            <div ref={messagesEndRef} />
                                        </div>
                                    ) : (
                                        <div className="flex-1 flex items-center justify-center">
                                            {status === 'idle' && <span className="text-slate-400 text-sm text-center px-6">–ù–∞–∂–º–∏—Ç–µ ¬´–ù–∞—á–∞—Ç—å¬ª ‚Äî —Ä–∞–∑–≥–æ–≤–æ—Ä –ø–æ—è–≤–∏—Ç—Å—è –∑–¥–µ—Å—å</span>}
                                            {status === 'error' && (
                                                <div className="flex flex-col items-center gap-1 text-red-500 px-4 text-center">
                                                    <span className="text-xs font-bold uppercase">–û—à–∏–±–∫–∞</span>
                                                    <span className="text-sm">{error}</span>
                                                </div>
                                            )}
                                        </div>
                                    )}

                                    {/* Waveform + controls */}
                                    <div className="flex-shrink-0 p-4 border-t border-slate-200/30 dark:border-slate-700/30 flex flex-col gap-3">
                                        {status === 'connecting' && (
                                            <div className="flex items-center justify-center gap-2 text-emerald-500 py-1">
                                                <Loader2 size={18} />
                                                <span className="text-xs font-bold uppercase tracking-widest">–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ...</span>
                                            </div>
                                        )}
                                        {status === 'connected' && (
                                            <div className="flex items-end justify-center gap-1 h-8">
                                                {[0,1,2,3,4,5,6,7].map(i => (
                                                    <div key={i} className="w-2 bg-emerald-500 rounded-full transition-all duration-300"
                                                        style={{ height: isAgentSpeaking ? `${30 + ((i*37+13)%60)}%` : '25%',
                                                                 opacity: isAgentSpeaking ? 1 : 0.4 }}></div>
                                                ))}
                                            </div>
                                        )}
                                        {!isActive ? (
                                            <button onClick={connect} className="w-full py-3 bg-emerald-500 text-white font-bold rounded-xl shadow-lg hover:bg-emerald-600 active:scale-95 transition-all flex items-center justify-center gap-2">
                                                <Mic size={18} /> –ù–∞—á–∞—Ç—å —Ä–∞–∑–≥–æ–≤–æ—Ä
                                            </button>
                                        ) : (
                                            <button onClick={stop} className="w-full py-3 bg-red-500 text-white font-bold rounded-xl shadow-lg hover:bg-red-600 active:scale-95 transition-all flex items-center justify-center gap-2">
                                                <Square size={18} /> –ó–∞–≤–µ—Ä—à–∏—Ç—å
                                            </button>
                                        )}
                                        <a href="https://storage.googleapis.com/uspeshnyy-projects/smit/smit34.ru/soglasie-PD.pdf" target="_blank" rel="noopener noreferrer" className="text-xs text-slate-400 hover:text-emerald-600 dark:hover:text-emerald-400 underline underline-offset-2 text-center transition-colors">–°–æ–≥–ª–∞—Å–µ–Ω –Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫—É –ø–µ—Ä—Å.–¥–∞–Ω–Ω—ã—Ö</a>
                                    </div>
                                </div>
                            )}
                        </div>

                        {/* Toggle Button */}
                        <button onClick={() => setIsOpen(!isOpen)}
                            className={`ai-widget-toggle pointer-events-auto w-14 h-14 rounded-full shadow-2xl flex items-center justify-center transition-all duration-300 hover:scale-110 active:scale-95 relative group ${isOpen ? 'ai-widget-toggle-open bg-slate-200 text-slate-600 dark:bg-slate-800 dark:text-slate-300' : 'bg-gradient-to-r from-emerald-500 to-teal-400 text-white'}`}>
                            {isOpen ? <X size={24} /> : <Bot size={24} />}
                            {!isOpen && (
                                <span className="absolute right-full mr-4 bg-white dark:bg-slate-800 text-slate-900 dark:text-white px-3 py-1 rounded-lg text-xs font-bold whitespace-nowrap opacity-0 group-hover:opacity-100 transition-opacity shadow-lg">
                                    AI –ê—Å—Å–∏—Å—Ç–µ–Ω—Ç
                                </span>
                            )}
                        </button>
                    </div>
                );
            }

            // --- –ì–õ–ê–í–ù–û–ï –ü–†–ò–õ–û–ñ–ï–ù–ò–ï ---
            function App() {
                const [mobileMenuOpen, setMobileMenuOpen] = useState(false);
                const [activeTab, setActiveTab] = useState('house');
                const [scrolled, setScrolled] = useState(false);
                const [showModal, setShowModal] = useState(false);
                const [noticeConfig, setNoticeConfig] = useState(null);
                const [activeService, setActiveService] = useState(null);
                const [activeDoc, setActiveDoc] = useState(null); // 'privacy' or 'agreement'
                const [lightboxOpen, setLightboxOpen] = useState(false);
                const [showMapModal, setShowMapModal] = useState(false);
                const [showSpeedtestModal, setShowSpeedtestModal] = useState(false);
                const [activeSpeedtestTab, setActiveSpeedtestTab] = useState('yandex');
                const [currentLicenseIndex, setCurrentLicenseIndex] = useState(0);
                const [showCookieConsent, setShowCookieConsent] = useState(false);
                const [checkResultModal, setCheckResultModal] = useState(false);
                const [touchStart, setTouchStart] = useState(null);
                const [touchEnd, setTouchEnd] = useState(null);
                const minSwipeDistance = 50;
                
                // Theme State
                const [theme, setTheme] = useState(
                    localStorage.theme || 
                    (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light')
                );

                useEffect(() => {
                    if (theme === 'dark') {
                        document.documentElement.classList.add('dark');
                        localStorage.setItem('theme', 'dark');
                    } else {
                        document.documentElement.classList.remove('dark');
                        localStorage.setItem('theme', 'light');
                    }
                }, [theme]);

                const toggleTheme = () => {
                    setTheme(prev => prev === 'dark' ? 'light' : 'dark');
                };

                // --- –ê–î–†–ï–° –ò –ü–û–î–°–ö–ê–ó–ö–ò ---
                const [addressQuery, setAddressQuery] = useState('');
                const [addressSuggestions, setAddressSuggestions] = useState([]);
                const [isSuggestionsOpen, setIsSuggestionsOpen] = useState(false);
                
                const mockAddresses = [
                    "–≥. –í–æ–ª–≥–æ–≥—Ä–∞–¥, —É–ª. 40 –ª–µ—Ç –í–õ–ö–°–ú",
                    "–≥. –í–æ–ª–≥–æ–≥—Ä–∞–¥, –ø—Ä-–∫—Ç –ì–µ—Ä–æ–µ–≤ –°—Ç–∞–ª–∏–Ω–≥—Ä–∞–¥–∞",
                    "–≥. –í–æ–ª–≥–æ–≥—Ä–∞–¥, —É–ª. –£–¥–º—É—Ä—Ç—Å–∫–∞—è",
                    "–≥. –í–æ–ª–≥–æ–≥—Ä–∞–¥, –±-—Ä –≠–Ω–≥–µ–ª—å—Å–∞",
                    "–≥. –í–æ–ª–≥–æ–≥—Ä–∞–¥, —É–ª. –û—Å—Ç—Ä–∞–≤—Å–∫–∞—è",
                    "–≥. –í–æ–ª–≥–æ–≥—Ä–∞–¥, —É–ª. –ü—Ä–æ–ª–µ—Ç–∞—Ä—Å–∫–∞—è",
                    "–≥. –í–æ–ª–≥–æ–≥—Ä–∞–¥, —É–ª. –ò–∑–æ–±–∏–ª—å–Ω–∞—è",
                    "–≥. –í–æ–ª–≥–æ–≥—Ä–∞–¥, —É–ª. –ì—Ä–∞–∂–¥–∞–Ω—Å–∫–∞—è",
                    "–≥. –í–æ–ª–≥–æ–≥—Ä–∞–¥, —É–ª. –î–æ–≤–∂–µ–Ω–∫–æ",
                    "–≥. –í–æ–ª–≥–æ–≥—Ä–∞–¥, —É–ª. –§–∞–¥–µ–µ–≤–∞",
                    "–≥. –í–æ–ª–≥–æ–≥—Ä–∞–¥, —É–ª. –ë–∞—Ö—Ç—É—Ä–æ–≤–∞",
                    "–≥. –í–æ–ª–≥–æ–≥—Ä–∞–¥, —É–ª. –í—É—á–µ—Ç–∏—á–∞",
                    "–≥. –í–æ–ª–≥–æ–≥—Ä–∞–¥, —É–ª. –†–æ—Å—Å–∏–π—Å–∫–∞—è"
                ];

                const handleAddressChange = (e) => {
                    const value = e.target.value;
                    setAddressQuery(value);
                    if (value.length > 0) {
                        const filtered = mockAddresses.filter(addr =>
                            addr.toLowerCase().includes(value.toLowerCase())
                        );
                        setAddressSuggestions(filtered);
                        setIsSuggestionsOpen(true);
                    } else {
                        setAddressSuggestions([]);
                        setIsSuggestionsOpen(false);
                    }
                };

                const handleSelectAddress = (addr) => {
                    setAddressQuery(addr);
                    setIsSuggestionsOpen(false);
                };

                const handleCheckAddress = () => {
                    if (addressQuery.trim().length > 0) {
                        trackGoal('check_address');
                        window.openAIWidget && window.openAIWidget(`–ü—Ä–∏–≤–µ—Ç, —è —Ö–æ—á—É –ø–æ–¥–∫–ª—é—á–∏—Ç—å –∏–Ω—Ç–µ—Ä–Ω–µ—Ç –ø–æ –∞–¥—Ä–µ—Å—É: ${addressQuery.trim()}`);
                    } else {
                        alert("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –∞–¥—Ä–µ—Å.");
                    }
                };
                
                const licenses = [
                    'https://storage.googleapis.com/uspeshnyy-projects/smit/smit34.ru/license1.jpg',
                    'https://storage.googleapis.com/uspeshnyy-projects/smit/smit34.ru/license2.jpg'
                ];

                const nextLicense = () => {
                    setCurrentLicenseIndex((prev) => (prev + 1) % licenses.length);
                };

                const prevLicense = () => {
                    setCurrentLicenseIndex((prev) => (prev - 1 + licenses.length) % licenses.length);
                };

                const onTouchStart = (e) => {
                    setTouchEnd(null);
                    setTouchStart(e.targetTouches[0].clientX);
                };

                const onTouchMove = (e) => setTouchEnd(e.targetTouches[0].clientX);

                const onTouchEnd = () => {
                    if (!touchStart || !touchEnd) return;
                    const distance = touchStart - touchEnd;
                    const isLeftSwipe = distance > minSwipeDistance;
                    const isRightSwipe = distance < -minSwipeDistance;
                    if (isLeftSwipe) {
                        nextLicense();
                    }
                    if (isRightSwipe) {
                        prevLicense();
                    }
                };

                const scrollToTop = () => {
                    window.scrollTo({ top: 0, behavior: 'smooth' });
                };

                // Refs
                const titleRef = useRef(null);
                const textRef = useRef(null);
                const checkBlockRef = useRef(null);
                const mobileMenuRef = useRef(null);
                const heroImageRef = useRef(null);
                const bizRobotRef = useRef(null);

                useEffect(() => {
                    // GSAP ScrollTrigger Animations
                    if (window.gsap && window.ScrollTrigger) {
                        gsap.registerPlugin(ScrollTrigger);
                        
                        // Refs Animation
                        const refsToAnimate = [titleRef.current, textRef.current, checkBlockRef.current].filter(Boolean);
                        
                        if (refsToAnimate.length > 0) {
                            window.gsap.set(refsToAnimate, { autoAlpha: 1 });

                            if(titleRef.current) {
                                gsap.fromTo(titleRef.current, 
                                    { y: 50, opacity: 0 },
                                    { y: 0, opacity: 1, duration: 1.2 }
                                );
                            }
                            if(textRef.current) {
                                gsap.fromTo(textRef.current, 
                                    { y: 30, opacity: 0 },
                                    { y: 0, opacity: 1, duration: 1 },
                                    "-=0.8"
                                );
                            }
                            if(checkBlockRef.current) {
                                gsap.fromTo(checkBlockRef.current,
                                    { scale: 0.8, opacity: 0, y: 20 },
                                    { scale: 1, opacity: 1, y: 0, duration: 0.8, ease: "back.out(1.7)" },
                                    "-=0.6"
                                );
                            }
                        }

                        // Animate Sections
                        const sections = document.querySelectorAll('.gsap-section');
                        sections.forEach(section => {
                             gsap.fromTo(section, 
                                { opacity: 0, y: 50 },
                                {
                                    opacity: 1,
                                    y: 0,
                                    duration: 1,
                                    ease: 'power3.out',
                                    scrollTrigger: {
                                        trigger: section,
                                        start: 'top 85%',
                                        toggleActions: 'play none none reverse'
                                    }
                                }
                            );
                        });

                        // Animate Grids with Cards
                        const grids = document.querySelectorAll('.grid');
                        grids.forEach(grid => {
                            const cards = grid.querySelectorAll('.gsap-card');
                            if (cards.length > 0) {
                                gsap.fromTo(cards, 
                                    { y: 50, opacity: 0 },
                                    {
                                        y: 0,
                                        opacity: 1,
                                        duration: 0.8,
                                        stagger: 0.15,
                                        ease: 'back.out(1.5)',
                                        scrollTrigger: {
                                            trigger: grid,
                                            start: 'top 85%',
                                        }
                                    }
                                );
                            }
                        });
                    }

                    const handleScroll = () => setScrolled(window.scrollY > 50);
                    window.addEventListener('scroll', handleScroll);

                    // --- COOKIE CONSENT LOGIC ---
                    const lastSeen = localStorage.getItem('smit_cookie_consent_time');
                    const now = new Date().getTime();
                    const oneDay = 24 * 60 * 60 * 1000;

                    let cookieTimer, cookieAutoHideTimer;
                    if (!lastSeen || (now - parseInt(lastSeen)) > oneDay) {
                        cookieTimer = setTimeout(() => {
                            setShowCookieConsent(true);
                            // –ê–≤—Ç–æ—Å–∫—Ä—ã—Ç–∏–µ —á–µ—Ä–µ–∑ 10 —Å–µ–∫—É–Ω–¥
                            cookieAutoHideTimer = setTimeout(() => {
                                setShowCookieConsent(false);
                            }, 10000);
                        }, 15000); // 15 seconds
                    }

                    // --- PARALLAX FOR IMAGE ---
                    const handleMouseMove = (e) => {
                        const { clientX, clientY } = e;
                        const { innerWidth, innerHeight } = window;

                        if (heroImageRef.current) {
                            const xOffset = (clientX / innerWidth - 0.5) * 20; 
                            const yOffset = (clientY / innerHeight - 0.5) * 20;
                            heroImageRef.current.style.transform = `translate(${xOffset}px, ${yOffset}px) rotateX(${yOffset * -0.5}deg) rotateY(${xOffset * 0.5}deg)`;
                        }

                        if (bizRobotRef.current) {
                            const xOffset = (clientX / innerWidth - 0.5) * 15;
                            const yOffset = (clientY / innerHeight - 0.5) * 15;
                            bizRobotRef.current.style.transform = `translate(${xOffset}px, ${yOffset}px) rotateX(${yOffset * -0.5}deg) rotateY(${xOffset * 0.5}deg)`;
                        }
                    };
                    window.addEventListener('mousemove', handleMouseMove);

                    // LOCK BODY SCROLL FOR MODAL
                    if (showModal) {
                        document.body.style.overflow = 'hidden';
                    } else {
                        document.body.style.overflow = 'unset';
                    }

                    return () => {
                        window.removeEventListener('scroll', handleScroll);
                        window.removeEventListener('mousemove', handleMouseMove);
                        document.body.style.overflow = 'unset';
                        if (cookieTimer) clearTimeout(cookieTimer);
                        if (cookieAutoHideTimer) clearTimeout(cookieAutoHideTimer);
                    };
                }, [showModal]);
                
                // NOTICE MODAL ‚Äî –∑–∞–≥—Ä—É–∂–∞–µ–º –∫–æ–Ω—Ñ–∏–≥ —Å —Å–µ—Ä–≤–µ—Ä–∞, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –µ—Å–ª–∏ enabled
                useEffect(() => {
                    let timer;
                    fetch('https://aida.smit34.ru/modal-config?_=' + Date.now())
                        .then(function(r) { return r.json(); })
                        .then(function(cfg) {
                            if (!cfg.enabled) return;
                            // –ü—Ä–æ–≤–µ—Ä–∫–∞ cookie (–Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω–æ –µ—Å–ª–∏ —É–∂–µ –±—ã–ª–æ)
                            if (!cfg.showOnEveryPageLoad) {
                                const cookieName = cfg.cookieName || 'smit27_modal_shown';
                                const match = document.cookie.match(new RegExp('(^| )' + cookieName + '=([^;]+)'));
                                if (match) return;
                                // –°—Ç–∞–≤–∏–º cookie
                                const expires = new Date(Date.now() + (cfg.cookieExpirationMinutes || 1440) * 60 * 1000).toUTCString();
                                document.cookie = cookieName + '=1; expires=' + expires + '; path=/; SameSite=Lax';
                            }
                            setNoticeConfig(cfg);
                            timer = setTimeout(function() { setShowModal(true); }, 5000);
                        })
                        .catch(function() { /* —Ç–∏—Ö–æ –∏–≥–Ω–æ—Ä–∏—Ä—É–µ–º –æ—à–∏–±–∫—É —Å–µ—Ç–∏ */ });
                    return function() { if (timer) clearTimeout(timer); };
                }, []);

                const handleAcceptCookies = () => {
                    localStorage.setItem('smit_cookie_consent_time', new Date().getTime().toString());
                    setShowCookieConsent(false);
                };

                useEffect(() => {
                    if (mobileMenuOpen && mobileMenuRef.current && window.gsap) {
                        const items = mobileMenuRef.current.querySelectorAll('.mobile-menu-item');
                        if(items.length) {
                            window.gsap.fromTo(items, 
                                { y: 30, opacity: 0 },
                                { y: 0, opacity: 1, duration: 0.5, stagger: 0.1, ease: "back.out(1.2)" }
                            );
                        }
                    }
                }, [mobileMenuOpen]);

                const scrollToSection = (id) => {
                    const element = document.getElementById(id);
                    if (element) {
                        element.scrollIntoView({ behavior: 'smooth' });
                        setMobileMenuOpen(false);
                    }
                };

                const navLinks = [
                    { name: '–î–æ–º', id: 'tariffs', tab: 'house' },
                    { name: '–ë–∏–∑–Ω–µ—Å', id: 'tariffs', tab: 'business' },
                    { name: '–£—Å–ª—É–≥–∏', id: 'services' },
                    { name: '–ü–æ–¥–¥–µ—Ä–∂–∫–∞', id: 'help' },
                ];

                const tariffsData = {
                    house: [
                        { name: '–≠—Ç–æ –ø—Ä–æ—Å—Ç–æ', speed: '25 –ú–±–∏—Ç/—Å', price: '869', features: ['–¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è GPON', '–û–ø—Ç–∏–∫–∞ –≤ –¥–æ–º', '–°—Ç–∞–±–∏–ª—å–Ω–æ –≤ –ª—é–±—É—é –ø–æ–≥–æ–¥—É'] },
                        { name: '–î–ª—è —Ç–µ–±—è', speed: '40 –ú–±–∏—Ç/—Å', price: '749', features: ['–¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è GPON', '–û–ø—Ç–∏–∫–∞ –≤ –¥–æ–º', '–°—Ç–∞–±–∏–ª—å–Ω–æ –≤ –ª—é–±—É—é –ø–æ–≥–æ–¥—É'] },
                        { name: 'Smit', speed: '100 –ú–±–∏—Ç/—Å', price: '949', isHit: true, features: ['–¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è GPON', '–û–ø—Ç–∏–∫–∞ –≤ –¥–æ–º', '–°—Ç–∞–±–∏–ª—å–Ω–æ –≤ –ª—é–±—É—é –ø–æ–≥–æ–¥—É'] },
                        { name: '–ë–µ–∑ –≥—Ä–∞–Ω–∏—Ü', speed: '150 –ú–±–∏—Ç/—Å', price: '1199', features: ['–¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è GPON', '–û–ø—Ç–∏–∫–∞ –≤ –¥–æ–º', '–°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π IP'] },
                        { name: '–°—É–ø–µ—Ä', speed: '–¥–æ 50 –ú–±–∏—Ç/—Å', price: '1199', features: ['–¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è –±–µ—Å–ø—Ä–æ–≤–æ–¥–Ω–æ–π wi-fi', '–ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è —É–¥–∞–ª—ë–Ω–Ω—ã—Ö —Ç–æ—á–µ–∫ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è'] },
                    ],
                    business: [
                        { name: '–°—Ç–∞—Ä—Ç', speed: '10 –ú–±–∏—Ç/—Å', price: '2990', features: ['–í—ã–¥–µ–ª–µ–Ω–Ω–∞—è –ª–∏–Ω–∏—è', '–¢–µ—Ö–ø–æ–¥–¥–µ—Ä–∂–∫–∞'] },
                        { name: '–û—Ñ–∏—Å', speed: '30 –ú–±–∏—Ç/—Å', price: '4990', features: ['–í—ã–¥–µ–ª–µ–Ω–Ω–∞—è –ª–∏–Ω–∏—è', 'SLA –≥–∞—Ä–∞–Ω—Ç–∏—è'] },
                        { name: '–ë–∏–∑–Ω–µ—Å', speed: '50 –ú–±–∏—Ç/—Å', price: '6790', isHit: true, features: ['–í—ã–¥–µ–ª–µ–Ω–Ω–∞—è –ª–∏–Ω–∏—è', 'SLA –≥–∞—Ä–∞–Ω—Ç–∏—è', '–°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π IP'] },
                        { name: '–ú–∞–∫—Å–∏–º—É–º', speed: '100 –ú–±–∏—Ç/—Å', price: '9990', features: ['–í—ã–¥–µ–ª–µ–Ω–Ω–∞—è –ª–∏–Ω–∏—è', 'SLA –≥–∞—Ä–∞–Ω—Ç–∏—è', '–ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä', '–°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π IP'] },
                    ]
                };

                const servicesDetails = {
                    tv: {
                        title: '–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ –¢–í',
                        subtitle: '–ë–æ–ª–µ–µ 200 –∫–∞–Ω–∞–ª–æ–≤ –≤ –≤—ã—Å–æ–∫–æ–º –∫–∞—á–µ—Å—Ç–≤–µ',
                        icon: Tv,
                        description: '–°–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–µ —Ç–µ–ª–µ–≤–∏–¥–µ–Ω–∏–µ —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —ç—Ñ–∏—Ä–æ–º. –°–º–æ—Ç—Ä–∏—Ç–µ –ª—é–±–∏–º—ã–µ –ø–µ—Ä–µ–¥–∞—á–∏ —Ç–æ–≥–¥–∞, –∫–æ–≥–¥–∞ —É–¥–æ–±–Ω–æ –≤–∞–º.',
                        features: ['–ê—Ä—Ö–∏–≤ –ø–µ—Ä–µ–¥–∞—á –∑–∞ 7 –¥–Ω–µ–π', '–ü–∞—É–∑–∞ –∏ –ø–µ—Ä–µ–º–æ—Ç–∫–∞', '–ü—Ä–æ—Å–º–æ—Ç—Ä –Ω–∞ 5 —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö', '–ö–∏–Ω–æ—Ç–µ–∞—Ç—Ä—ã (START, Premier)'],
                        image: 'https://storage.googleapis.com/uspeshnyy-projects/smit/smit34.ru/smitrobot_tv.jpg',
                        prices: [
                            { name: '–°—Ç–∞–Ω–¥–∞—Ä—Ç', detail: '–ë–∞–∑–æ–≤—ã–π –ø–∞–∫–µ—Ç –∫–∞–Ω–∞–ª–æ–≤', price: '249 ‚ÇΩ' },
                            { name: '–û–ø—Ç–∏–º–∞', detail: '–†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π –ø–∞–∫–µ—Ç', price: '499 ‚ÇΩ' },
                            { name: '–≠–∫—Å–∫–ª—é–∑–∏–≤', detail: '–ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –ø–∞–∫–µ—Ç', price: '999 ‚ÇΩ' },
                        ],
                        cta: '–ü–æ–¥–∫–ª—é—á–∏—Ç—å –¢–í',
                        aiMessage: '–ü—Ä–∏–≤–µ—Ç, —è —Ö–æ—á—É –ø–æ–¥–∫–ª—é—á–∏—Ç—å –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ –¢–í'
                    },
                    cctv: {
                        title: '–í–∏–¥–µ–æ–Ω–∞–±–ª—é–¥–µ–Ω–∏–µ',
                        subtitle: '–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –≤–∞—à–µ–≥–æ –¥–æ–º–∞',
                        icon: Shield,
                        description: '–û–±–ª–∞—á–Ω–æ–µ –≤–∏–¥–µ–æ–Ω–∞–±–ª—é–¥–µ–Ω–∏–µ –¥–ª—è —á–∞—Å—Ç–Ω—ã—Ö –¥–æ–º–æ–≤ –∏ –¥–≤–æ—Ä–æ–≤. –î–æ—Å—Ç—É–ø –∫ –∫–∞–º–µ—Ä–∞–º –∏–∑ –ª—é–±–æ–π —Ç–æ—á–∫–∏ –º–∏—Ä–∞ —á–µ—Ä–µ–∑ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ.',
                        features: ['–ó–∞–ø–∏—Å—å –≤ –æ–±–ª–∞–∫–æ 24/7', '–î–æ—Å—Ç—É–ø —Å–æ —Å–º–∞—Ä—Ç—Ñ–æ–Ω–∞', '–î–∞—Ç—á–∏–∫–∏ –¥–≤–∏–∂–µ–Ω–∏—è', '–ù–æ—á–Ω–∞—è —Å—ä–µ–º–∫–∞'],
                        image: 'https://storage.googleapis.com/uspeshnyy-projects/smit/smit34.ru/smitrobot_video.jpg',
                        prices: [
                            { name: '–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫–∞–º–µ—Ä—ã –ø–æ–¥ –∫–ª—é—á', detail: '–ú–æ–Ω—Ç–∞–∂, –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ', price: '13 500 ‚ÇΩ' },
                        ],
                        cta: '–ó–∞–∫–∞–∑–∞—Ç—å —É—Å—Ç–∞–Ω–æ–≤–∫—É',
                        aiMessage: '–ü—Ä–∏–≤–µ—Ç, —è —Ö–æ—á—É –∑–∞–∫–∞–∑–∞—Ç—å —É—Å—Ç–∞–Ω–æ–≤–∫—É –≤–∏–¥–µ–æ–Ω–∞–±–ª—é–¥–µ–Ω–∏—è'
                    },
                    pc: {
                        title: '–ö–æ–º–ø—å—é—Ç–µ—Ä–Ω—ã–π —Å–µ—Ä–≤–∏—Å',
                        subtitle: '–°–∫–æ—Ä–∞—è –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω–∞—è –ø–æ–º–æ—â—å',
                        icon: Cpu,
                        description: '–ö–≤–∞–ª–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ä–µ–º–æ–Ω—Ç –∫–æ–º–ø—å—é—Ç–µ—Ä–æ–≤ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è –æ—Ç –∏–Ω–∂–µ–Ω–µ—Ä–æ–≤ SmIT. –í—ã–µ–∑–¥ –Ω–∞ –¥–æ–º.',
                        features: ['–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –±–µ—Å–ø–ª–∞—Ç–Ω–æ', '–ì–∞—Ä–∞–Ω—Ç–∏—è –Ω–∞ —Ä–∞–±–æ—Ç—ã', '–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª—é–±–æ–≥–æ –ü–û', '–ß–∏—Å—Ç–∫–∞ –æ—Ç –ø—ã–ª–∏'],
                        image: 'https://storage.googleapis.com/uspeshnyy-projects/smit/smit34.ru/smitrobot_support.jpg',
                        prices: [
                            { name: '–ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–æ—É—Ç–µ—Ä–∞', detail: '–õ—é–±–∞—è –º–æ–¥–µ–ª—å', price: '500 ‚ÇΩ' },
                            { name: '–û–±–∂–∏–º –∫–∞–±–µ–ª—è', detail: '–ó–∞ –∫–æ–Ω–Ω–µ–∫—Ç–æ—Ä', price: '100 ‚ÇΩ' },
                        ],
                        cta: '–í—ã–∑–≤–∞—Ç—å –º–∞—Å—Ç–µ—Ä–∞',
                        aiMessage: '–ü—Ä–∏–≤–µ—Ç, —è —Ö–æ—á—É –≤—ã–∑–≤–∞—Ç—å –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω–æ–≥–æ –º–∞—Å—Ç–µ—Ä–∞'
                    },
                    documents: {
                       title: '–î–æ–∫—É–º–µ–Ω—Ç—ã',
                       subtitle: '–û—Ñ–µ—Ä—Ç—ã –∏ —Ä–µ–≥–ª–∞–º–µ–Ω—Ç—ã',
                       icon: FileText,
                       description: '–û—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã, —Ä–µ–≥–ª–∞–º–µ–Ω—Ç–∏—Ä—É—é—â–∏–µ –æ–∫–∞–∑–∞–Ω–∏–µ —É—Å–ª—É–≥ —Å–≤—è–∑–∏.',
                       fileList: [
                           { name: '–†–µ–≥–ª–∞–º–µ–Ω—Ç –æ–∫–∞–∑–∞–Ω–∏—è —É—Å–ª—É–≥ —Å–≤—è–∑–∏', desc: 'https://storage.googleapis.com/uspeshnyy-projects/smit/smit34.ru/SMIT_Reglament.pdf', size: '100 KB', type: 'pdf', iconType: FileText },
                           { name: '–°–æ–≥–ª–∞—Å–∏–µ –Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫—É –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö', desc: 'https://storage.googleapis.com/uspeshnyy-projects/smit/smit34.ru/Personal_Data.pdf', size: '25 KB', type: 'pdf', iconType: FileText },
                           { name: '–£—Å–ª–æ–≤–∏—è –¥–æ–≥–æ–≤–æ—Ä–∞ —Å —Ñ–∏–∑–∏—á–µ—Å–∫–∏–º–∏ –ª–∏—Ü–∞–º–∏', desc: 'https://storage.googleapis.com/uspeshnyy-projects/smit/smit34.ru/Terms_of_Agreement.pdf', size: '212 KB', type: 'pdf', iconType: FileText },
                           { name: '–ü—É–±–ª–∏—á–Ω–∞—è –æ—Ñ–µ—Ä—Ç–∞ (IPTV)', desc: 'https://storage.googleapis.com/uspeshnyy-projects/smit/smit34.ru/IPTV_offer.pdf', size: '178 KB', type: 'pdf', iconType: FileText },
                           { name: '–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è', desc: 'https://storage.googleapis.com/uspeshnyy-projects/smit/smit34.ru/Telecom_Equipment.pdf', size: '62 KB', type: 'pdf', iconType: FileText },
                       ],
                       cta: '–ó–∞–∫—Ä—ã—Ç—å',
                   },
                    instructions: {
                        title: '–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏',
                        subtitle: '–ü–æ—à–∞–≥–æ–≤—ã–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞',
                        icon: Settings,
                        description: '–ó–¥–µ—Å—å —Å–æ–±—Ä–∞–Ω—ã –ø–æ–¥—Ä–æ–±–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –æ–ø–ª–∞—Ç–µ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—é —É—Å–ª—É–≥–∞–º–∏.',
                        accordionItems: [
                            {
                                title: "–ö–∞–∫ –æ–ø–ª–∞—Ç–∏—Ç—å",
                                content: (
                                    <div className="space-y-6 text-sm text-slate-600 dark:text-slate-300">
                                        <div>
                                            <h5 className="font-bold text-slate-800 dark:text-slate-100 mb-2">1. –° –ø–æ–º–æ—â—å—é –ª—é–±–æ–π –ë–∞–Ω–∫–æ–≤—Å–∫–æ–π –ö–∞—Ä—Ç—ã</h5>
                                            <ol className="list-decimal pl-4 space-y-1 marker:text-emerald-500">
                                                <li>–ó–∞–π–¥–∏—Ç–µ –Ω–∞ —Å–∞–π—Ç <a href="https://www.smit34.ru" className="text-emerald-600 hover:underline">www.smit34.ru</a></li>
                                                <li>–ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ —Ä–∞–∑–¥–µ–ª "–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç".</li>
                                                <li>–í–≤–µ–¥–∏—Ç–µ "–õ–æ–≥–∏–Ω" –∏ "–ü–∞—Ä–æ–ª—å" —Å –≤–∞—à–µ–π –∫–∞—Ä—Ç–æ—á–∫–∏ –∞–±–æ–Ω–µ–Ω—Ç–∞ –∏ –≤–æ–π–¥–∏—Ç–µ –≤ —Å–≤–æ–π –ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç.</li>
                                                <li>–í—ã–±–µ—Ä–∏—Ç–µ —Ä–∞–∑–¥–µ–ª "–ü–æ–ø–æ–ª–Ω–∏—Ç—å —Å—á–µ—Ç" =&gt; "–ï–¥–∏–Ω–∞—è –∫–∞—Å—Å–∞" =&gt; "–û–∫".</li>
                                                <li>–í –ø–æ–ª–µ –≤–≤–æ–¥–∞ –≤–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É –∫–æ—Ç–æ—Ä—É—é –≤—ã —Ö–æ—Ç–∏—Ç–µ –≤–Ω–µ—Å—Ç–∏ –Ω–∞ —Å–≤–æ–π —Å—á–µ—Ç =&gt; "–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å".</li>
                                                <li>–í –æ—Ç–∫—Ä—ã–≤—à–µ–º—Å—è –æ–∫–Ω–µ –≤—ã–±–µ—Ä–∏—Ç–µ —Å–ø–æ—Å–æ–± "–ö–∞—Ä—Ç—ã –†–æ—Å—Å–∏–∏ –∏ –°–ù–ì".</li>
                                                <li>–í–≤–µ–¥–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –∫–∞—Ä—Ç—ã –∏ email =&gt; "–î–∞–ª–µ–µ".</li>
                                                <li>–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –ø–ª–∞—Ç–µ–∂ –∏ –æ–∂–∏–¥–∞–π—Ç–µ –∑–∞—á–∏—Å–ª–µ–Ω–∏—è.</li>
                                            </ol>
                                            <p className="mt-2 italic text-xs">–ó–∞—á–∏—Å–ª–µ–Ω–∏–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤ —Ç–µ—á–µ–Ω–∏–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –º–∏–Ω—É—Ç. –ï—Å–ª–∏ –¥–ª—è –æ–ø–ª–∞—Ç—ã –Ω—É–∂–µ–Ω –∏–Ω—Ç–µ—Ä–Ω–µ—Ç, –≤–æ—Å–ø–æ–ª—å–∑—É–π—Ç–µ—Å—å "–û–±–µ—â–∞–Ω–Ω—ã–º –ø–ª–∞—Ç–µ–∂–æ–º".</p>
                                        </div>
                                        <div>
                                            <h5 className="font-bold text-slate-800 dark:text-slate-100 mb-2">2. –ü–æ –∫–≤–∏—Ç–∞–Ω—Ü–∏–∏ —á–µ—Ä–µ–∑ –±–∞–Ω–∫</h5>
                                            <ol className="list-decimal pl-4 space-y-1 marker:text-emerald-500">
                                                <li>–°–∫–∞—á–∞–π—Ç–µ –±–ª–∞–Ω–∫ –∫–≤–∏—Ç–∞–Ω—Ü–∏–∏ —Å –Ω–∞—à–µ–≥–æ —Å–∞–π—Ç–∞.</li>
                                                <li>–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –Ω–æ–º–µ—Ä –¥–æ–≥–æ–≤–æ—Ä–∞ –∏ –§–ò–û.</li>
                                                <li>–û–ø–ª–∞—Ç–∏—Ç–µ –≤ –ª—é–±–æ–º –æ—Ç–¥–µ–ª–µ–Ω–∏–∏ –±–∞–Ω–∫–∞.</li>
                                            </ol>
                                        </div>
                                    </div>
                                )
                            },
                            {
                                title: "–û–±–µ—â–∞–Ω–Ω—ã–π –ø–ª–∞—Ç–µ–∂",
                                content: (
                                    <div className="space-y-4 text-sm text-slate-600 dark:text-slate-300">
                                        <p>–ü–æ–¥–∫–ª—é—á–∞—è —É—Å–ª—É–≥—É "–û–±–µ—â–∞–Ω–Ω—ã–π –ø–ª–∞—Ç–µ–∂", –≤—ã –¥–æ–±—Ä–æ–≤–æ–ª—å–Ω–æ –æ–±—è–∑—É–µ—Ç–µ—Å—å –æ–ø–ª–∞—Ç–∏—Ç—å –∏–Ω—Ç–µ—Ä–Ω–µ—Ç –≤ –¥–∞–Ω–Ω–æ–º –º–µ—Å—è—Ü–µ.</p>
                                        <ol className="list-decimal pl-4 space-y-2 marker:text-emerald-500">
                                            <li>–í–æ–π–¥–∏—Ç–µ –≤ –≤–∞—à –ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç, –∏—Å–ø–æ–ª—å–∑—É—è –≤–∞—à –ª–æ–≥–∏–Ω –∏ –ø–∞—Ä–æ–ª—å.</li>
                                            <li>–í—ã–±–µ—Ä–∏—Ç–µ –≤–∫–ª–∞–¥–∫—É ¬´–û–ø–µ—Ä–∞—Ü–∏–∏ —Å –±–∞–ª–∞–Ω—Å–æ–º¬ª.</li>
                                            <li>–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Å—É–º–º—É –æ–±–µ—â–∞–Ω–Ω–æ–≥–æ –ø–ª–∞—Ç–µ–∂–∞ (—Ä–∞–≤–Ω–∞ —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –≤–∞—à–µ–≥–æ —Ç–∞—Ä–∏—Ñ–∞).</li>
                                            <li>–ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É ¬´–í–∑—è—Ç—å¬ª.</li>
                                            <li>–í —Ç–µ—á–µ–Ω–∏–µ <strong>5 –¥–Ω–µ–π</strong> –æ–ø–ª–∞—Ç–∏—Ç–µ –≤–∑—è—Ç—É—é –≤–∞–º–∏ —Å—É–º–º—É —Ä–µ–∞–ª—å–Ω—ã–º–∏ —Å—Ä–µ–¥—Å—Ç–≤–∞–º–∏.</li>
                                        </ol>
                                    </div>
                                )
                            }
                        ],
                        cta: '–ü–µ—Ä–µ–π—Ç–∏ –≤ —Ä–∞–∑–¥–µ–ª –ü–æ–º–æ—â—å'
                    },
                    payment: {
                        title: '–û–ø–ª–∞—Ç–∞',
                        subtitle: '–ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞',
                        icon: CreditCard,
                        description: '–û–ø–ª–∞—á–∏–≤–∞–π—Ç–µ —É—Å–ª—É–≥–∏ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞ –∏ —Ç–µ–ª–µ–≤–∏–¥–µ–Ω–∏—è –æ–Ω–ª–∞–π–Ω –±–µ–∑ –∫–æ–º–∏—Å—Å–∏–∏. –°—Ä–µ–¥—Å—Ç–≤–∞ –∑–∞—á–∏—Å–ª—è—é—Ç—Å—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ.',
                        cta: '–ü–µ—Ä–µ–π—Ç–∏ –∫ –æ–ø–ª–∞—Ç–µ', 
                        isPayment: true 
                    }
                };

                return (
                    <div className="min-h-screen text-slate-800 dark:text-slate-200 font-sans selection:bg-emerald-200 dark:selection:bg-emerald-800 overflow-x-hidden">
                        <GeometricBackground isDark={theme === 'dark'} />

                        {/* HEADER */}
                        <header className={`fixed top-0 w-full z-50 transition-all duration-300 ${scrolled ? 'py-2 bg-white/80 dark:bg-slate-900/80 backdrop-blur-xl border-b border-emerald-100/50 dark:border-emerald-900/50 shadow-sm' : 'py-4 bg-transparent'}`}>
                            <div className="container mx-auto px-4 md:px-8 flex justify-between items-center">
                                {/* Logo */}
                                <div className="flex items-center gap-2 cursor-pointer" onClick={scrollToTop}>
                                    <div className="w-10 h-10 bg-gradient-to-br from-emerald-500 to-teal-400 rounded-lg flex items-center justify-center text-white font-bold text-xl shadow-lg shadow-emerald-500/20">S</div>
                                    <span className="text-2xl font-bold tracking-tight text-slate-800 dark:text-white">SmIT</span>
                                </div>

                                {/* Desktop Nav */}
                                <nav className="hidden lg:flex items-center gap-8 bg-white/40 dark:bg-slate-800/40 px-8 py-2 rounded-full border border-white/60 dark:border-slate-700/60 backdrop-blur-md">
                                    {navLinks.map((link) => (
                                        <button 
                                            key={link.name} 
                                            onClick={() => {
                                                scrollToSection(link.id);
                                                if(link.tab) setActiveTab(link.tab);
                                            }}
                                            className="text-sm font-medium text-slate-600 dark:text-slate-300 hover:text-emerald-600 dark:hover:text-emerald-400 transition-colors"
                                        >
                                            {link.name}
                                        </button>
                                    ))}
                                </nav>

                                {/* Actions */}
                                <div className="hidden lg:flex items-center gap-4">
                                    {/* Theme Toggle */}
                                    <button 
                                        onClick={toggleTheme} 
                                        className="p-2 text-slate-500 dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-full transition-colors"
                                        title={theme === 'dark' ? '–í–∫–ª—é—á–∏—Ç—å —Å–≤–µ—Ç–ª—É—é —Ç–µ–º—É' : '–í–∫–ª—é—á–∏—Ç—å —Ç–µ–º–Ω—É—é —Ç–µ–º—É'}
                                    >
                                        {theme === 'dark' ? <Sun size={20} /> : <Moon size={20} />}
                                    </button>

                                    <div className="flex flex-col items-end mr-2">
                                        <a href="tel:+79375551122" className="text-sm font-bold text-slate-800 dark:text-slate-200 hover:text-emerald-600 dark:hover:text-emerald-400 transition-colors">+7 (937) 555-11-22</a>
                                    </div>
                                    <a href="#" className="p-2 text-emerald-600 dark:text-emerald-400 hover:bg-emerald-50 dark:hover:bg-emerald-900/30 rounded-full transition-colors" title="–ë—ã—Å—Ç—Ä–∞—è –æ–ø–ª–∞—Ç–∞" onClick={() => setActiveService('payment')}>
                                        <CreditCard size={20} />
                                    </a>
                                    <Button primary className="!px-4 !py-2 !rounded-lg text-sm" onClick={() => { trackGoal('open_cabinet'); window.open('https://bill.smit34.ru', '_blank'); }}>
                                        <User size={16} /> –ö–∞–±–∏–Ω–µ—Ç
                                    </Button>
                                </div>

                                {/* Mobile Menu Toggle */}
                                <button className="lg:hidden p-2 text-slate-700 dark:text-slate-200 z-[110] relative" onClick={() => setMobileMenuOpen(!mobileMenuOpen)}>
                                    {mobileMenuOpen ? <X size={28} /> : <Menu size={28} />}
                                </button>
                            </div>
                        </header>

                        {/* FULLSCREEN MOBILE MENU */}
                        {mobileMenuOpen && (
                            <div className="fixed inset-0 z-[100] bg-white/98 dark:bg-slate-900/98 backdrop-blur-xl flex flex-col items-center justify-center p-6 animate-in fade-in duration-300">
                                <button onClick={() => setMobileMenuOpen(false)} className="absolute top-5 right-5 w-11 h-11 flex items-center justify-center rounded-full bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-300 hover:bg-slate-200 dark:hover:bg-slate-700 transition-colors">
                                    <X size={22} />
                                </button>
                                <div ref={mobileMenuRef} className="flex flex-col items-center gap-8 w-full max-w-sm">
                                    {/* Mobile Theme Toggle */}
                                    <button 
                                        onClick={toggleTheme}
                                        className="p-3 bg-slate-100 dark:bg-slate-800 rounded-full mb-4 mobile-menu-item"
                                    >
                                        {theme === 'dark' ? <Sun size={24} className="text-yellow-500"/> : <Moon size={24} className="text-slate-600"/>}
                                    </button>

                                    {navLinks.map((link) => (
                                        <button 
                                            key={link.name} 
                                            onClick={() => {
                                                scrollToSection(link.id);
                                                if(link.tab) setActiveTab(link.tab);
                                                setMobileMenuOpen(false);
                                            }}
                                            className="mobile-menu-item text-3xl font-bold text-slate-800 dark:text-white hover:text-emerald-600 dark:hover:text-emerald-400 transition-colors"
                                        >
                                            {link.name}
                                        </button>
                                    ))}

                                    <div className="mobile-menu-item w-full">
                                        <button
                                            onClick={() => {
                                                window.openAIWidget && window.openAIWidget();
                                                setMobileMenuOpen(false);
                                            }}
                                            className="w-full justify-center relative group px-4 py-3 rounded-xl font-semibold text-white bg-gradient-to-r from-purple-600 to-indigo-600 shadow-lg shadow-purple-500/30 flex items-center gap-2 text-lg"
                                        >
                                            <Bot size={20} />
                                            <span>AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç</span>
                                        </button>
                                    </div>
                                    
                                    <div className="w-full flex flex-col gap-4 mobile-menu-item">
                                        <Button onClick={() => { trackGoal('open_cabinet'); window.open('https://bill.smit34.ru', '_blank'); }} className="w-full justify-center text-lg py-4">
                                            <User size={20} /> –õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç
                                        </Button>
                                    </div>

                                    <div className="flex flex-col items-center gap-2 mt-8 mobile-menu-item">
                                        <a href="tel:+79375551122" className="text-2xl font-bold text-emerald-600 dark:text-emerald-400" onClick={() => trackGoal('click_phone')}>+7 (937) 555-11-22</a>
                                        <span className="text-slate-400 dark:text-slate-500">–†–∞–±–æ—Ç–∞–µ–º –∫—Ä—É–≥–ª–æ—Å—É—Ç–æ—á–Ω–æ</span>
                                    </div>
                                </div>
                            </div>
                        )}

                        {/* HERO SECTION */}
                        <section className="relative pt-32 pb-20 md:pt-48 md:pb-32 px-4 overflow-hidden gsap-section">
                            <div className="container mx-auto max-w-6xl relative z-10 flex flex-col md:flex-row items-center justify-between gap-8">
                                <div className="max-w-2xl">
                                    <Badge>–ù–æ–≤–∞—è –≠—Ä–∞ –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–π</Badge>
                                    
                                    <h1 ref={titleRef} style={{opacity: 0}} className="text-4xl md:text-6xl lg:text-7xl font-bold leading-[1.1] mb-6 text-slate-900 dark:text-white">
                                        –°—Ç–∞–±–∏–ª—å–Ω—ã–π –ò–Ω—Ç–µ—Ä–Ω–µ—Ç <br/>
                                        <span className="text-transparent bg-clip-text bg-gradient-to-r from-emerald-500 to-teal-400">
                                            –≤ –í–æ–ª–≥–æ–≥—Ä–∞–¥—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏
                                        </span>
                                    </h1>

                                    <p ref={textRef} style={{opacity: 0}} className="text-lg md:text-xl text-slate-600 dark:text-slate-300 mb-8 max-w-lg leading-relaxed glass-text">
                                        –ë–µ—Å–ø–ª–∞—Ç–Ω–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫–≤–∞—Ä—Ç–∏—Ä –∏ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è GPON –≤ —á–∞—Å—Ç–Ω—ã–π —Å–µ–∫—Ç–æ—Ä. –°–∫–æ—Ä–æ—Å—Ç—å —Å–≤–µ—Ç–∞ –≤ –≤–∞—à–µ–º –¥–æ–º–µ.
                                    </p>

                                    <div ref={checkBlockRef} style={{opacity: 0}} className="glass-panel p-2 rounded-2xl bg-white/60 dark:bg-slate-800/60 backdrop-blur-md border border-white/50 dark:border-slate-700/50 shadow-lg inline-flex flex-col relative w-full md:w-auto">
                                        <div className="flex flex-col md:flex-row gap-2 w-full">
                                            <div className="relative w-full md:w-80">
                                                <input 
                                                    type="text" 
                                                    placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à –∞–¥—Ä–µ—Å..." 
                                                    className="bg-transparent px-4 py-3 outline-none text-slate-800 dark:text-white placeholder:text-slate-400 w-full"
                                                    value={addressQuery}
                                                    onChange={handleAddressChange}
                                                    onFocus={() => { if(addressSuggestions.length > 0) setIsSuggestionsOpen(true); }}
                                                    onBlur={() => setTimeout(() => setIsSuggestionsOpen(false), 200)}
                                                />
                                                {/* Autocomplete Dropdown - Z-Index Increased */}
                                                {isSuggestionsOpen && addressSuggestions.length > 0 && (
                                                    <div className="absolute top-full left-0 w-full bg-white dark:bg-slate-800 rounded-xl shadow-xl mt-2 border border-slate-100 dark:border-slate-700 overflow-hidden z-[60] animate-in fade-in duration-200">
                                                        <ul>
                                                            {addressSuggestions.map((addr, idx) => (
                                                                <li 
                                                                    key={idx}
                                                                    className="px-4 py-2 hover:bg-emerald-50 dark:hover:bg-slate-700 cursor-pointer text-slate-600 dark:text-slate-300 text-sm transition-colors border-b border-slate-50 dark:border-slate-700 last:border-0"
                                                                    onClick={() => handleSelectAddress(addr)}
                                                                >
                                                                    {addr}
                                                                </li>
                                                            ))}
                                                        </ul>
                                                    </div>
                                                )}
                                            </div>
                                            <Button primary className="w-full md:w-auto whitespace-nowrap justify-center" onClick={handleCheckAddress}>
                                                –ü—Ä–æ–≤–µ—Ä–∏—Ç—å <span className="hidden md:inline">–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å</span>
                                            </Button>
                                        </div>
                                    </div>
                                </div>
                                
                                <div className="md:w-1/2 flex justify-center md:justify-end animate-in fade-in slide-in-from-right duration-700 delay-300">
                                    <div className="relative w-full max-w-md h-auto" style={{perspective: '1000px'}}>
                                        {/* Placeholder Robot */}
                                        <img 
                                            ref={heroImageRef}
                                            src="https://storage.googleapis.com/uspeshnyy-projects/smit/smit34.ru/smitrobot.png" 
                                            alt="–†–æ–±–æ—Ç-–ø–æ–º–æ—â–Ω–∏–∫ SMIT" 
                                            className="w-full h-auto object-cover rounded-3xl transition-transform duration-100 ease-out hover:scale-105 drop-shadow-2xl aspect-square"
                                            style={{transformStyle: 'preserve-3d'}}
                                        />
                                        <div className="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-full h-full bg-emerald-500/20 blur-[100px] rounded-full -z-10 pointer-events-none"></div>
                                    </div>
                                </div>
                            </div>
                        </section>

                        {/* CHECK RESULT MODAL */}
                        {checkResultModal && (
                            <div className="fixed inset-0 z-[200] flex items-center justify-center p-4 bg-black/90 backdrop-blur-md animate-in fade-in duration-300">
                                <GlassCard className="max-w-lg w-full bg-white dark:bg-slate-900 relative p-8">
                                    <button 
                                        onClick={() => setCheckResultModal(false)}
                                        className="absolute top-4 right-4 text-slate-400 hover:text-slate-600 dark:hover:text-slate-200 transition-colors"
                                    >
                                        <X size={24} />
                                    </button>
                                    <div className="text-center">
                                         <div className="w-16 h-16 bg-emerald-100 dark:bg-emerald-900/50 rounded-full flex items-center justify-center mx-auto mb-4">
                                            <Check size={32} className="text-emerald-600 dark:text-emerald-400" />
                                        </div>
                                        <h3 className="text-2xl font-bold text-slate-900 dark:text-white mb-2">–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –µ—Å—Ç—å!</h3>
                                        <p className="text-slate-600 dark:text-slate-300 mb-6">
                                            –ü–æ –∞–¥—Ä–µ—Å—É: <br/>
                                            <span className="font-bold text-slate-800 dark:text-white">{addressQuery}</span>
                                        </p>
                                        <Button primary className="w-full justify-center" onClick={() => window.open('https://bill.smit34.ru', '_blank')}>
                                            –ü–æ–¥–∫–ª—é—á–∏—Ç—å –∏–Ω—Ç–µ—Ä–Ω–µ—Ç
                                        </Button>
                                    </div>
                                </GlassCard>
                            </div>
                        )}

                        {/* TARIFFS SECTION */}
                        <section id="tariffs" className="py-20 px-4 gsap-section">
                            <div className="container mx-auto max-w-6xl">
                                <div className="text-center mb-12">
                                    <h2 className="text-3xl md:text-5xl font-bold mb-4 text-slate-900 dark:text-white">–¢–∞—Ä–∏—Ñ–Ω—ã–µ –ø–ª–∞–Ω—ã</h2>
                                    <p className="text-slate-500 dark:text-slate-400 max-w-xl mx-auto">–ß–µ—Å—Ç–Ω—ã–µ —Å–∫–æ—Ä–æ—Å—Ç–∏. –ë–µ–∑ —Å–∫—Ä—ã—Ç—ã—Ö —É—Å–ª–æ–≤–∏–π. –í—ã–±–µ—Ä–∏—Ç–µ —Ç–æ, —á—Ç–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –∏–º–µ–Ω–Ω–æ –≤–∞–º.</p>
                                </div>

                                <div className="flex justify-center mb-12">
                                    <div className="bg-slate-200/50 dark:bg-slate-800/50 backdrop-blur-sm p-1.5 rounded-2xl inline-flex gap-2">
                                        {[
                                            { id: 'house', label: '–î–æ–º', icon: MapPin },
                                            { id: 'business', label: '–ë–∏–∑–Ω–µ—Å', icon: Server }
                                        ].map((tab) => (
                                            <button
                                                key={tab.id}
                                                onClick={() => setActiveTab(tab.id)}
                                                className={`
                                                    px-6 py-3 rounded-xl text-sm font-bold flex items-center gap-2 transition-all duration-300
                                                    ${activeTab === tab.id 
                                                    ? 'bg-white dark:bg-slate-700 text-slate-900 dark:text-white shadow-md scale-105' 
                                                    : 'text-slate-500 dark:text-slate-400 hover:text-slate-700 dark:hover:text-slate-200 hover:bg-slate-200/50 dark:hover:bg-slate-700/50'}
                                                `}
                                            >
                                                <tab.icon size={16} />
                                                {tab.label}
                                            </button>
                                        ))}
                                    </div>
                                </div>

                                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                                    {tariffsData[activeTab].map((tariff, index) => (
                                        <GlassCard
                                            key={index}
                                            animateIn
                                            hoverEffect={false}
                                            className={`gsap-card relative flex flex-col overflow-hidden group
                                                bg-gradient-to-br from-white/95 via-white/80 to-emerald-50/60
                                                dark:from-slate-800/90 dark:via-slate-800/70 dark:to-emerald-950/50
                                                border border-white/90 dark:border-emerald-900/30
                                                shadow-md
                                                hover:shadow-[0_20px_60px_rgba(16,185,129,0.22)] dark:hover:shadow-[0_20px_60px_rgba(16,185,129,0.18)]
                                                hover:-translate-y-3 transition-all duration-500 ease-out
                                                ${tariff.isHit ? 'ring-2 ring-emerald-400/60 dark:ring-emerald-500/40' : ''}
                                            `}
                                            style={{animationDelay: `${index * 0.1}s`}}
                                        >
                                            {/* Shimmer overlay on hover */}
                                            <div className="absolute inset-0 bg-gradient-to-br from-emerald-400/8 via-transparent to-blue-400/5 opacity-0 group-hover:opacity-100 transition-opacity duration-500 pointer-events-none" />
                                            {/* Top accent line */}
                                            <div className={`absolute top-0 left-0 right-0 h-0.5 bg-gradient-to-r from-transparent via-emerald-400/60 to-transparent transition-opacity duration-500 ${tariff.isHit ? 'opacity-100' : 'opacity-0 group-hover:opacity-100'}`} />

                                            {tariff.isHit && (
                                                <div className="absolute top-0 left-1/2 -translate-x-1/2 -translate-y-1/2 bg-gradient-to-r from-emerald-500 to-emerald-400 text-white text-xs font-bold px-3 py-1 rounded-full shadow-lg shadow-emerald-500/40">
                                                    –•–ò–¢ –ü–†–û–î–ê–ñ
                                                </div>
                                            )}

                                            <h3 className="text-2xl font-bold mb-2 relative">{tariff.name}</h3>
                                            <div className="text-4xl font-extrabold text-slate-800 dark:text-white mb-1 relative">
                                                {tariff.speed}
                                            </div>

                                            <div className="my-6 space-y-3 flex-1 relative">
                                                {tariff.features.map((feature, idx) => (
                                                    <div key={idx} className="flex items-center gap-3 text-slate-600 dark:text-slate-300 text-sm">
                                                        <div className="w-5 h-5 rounded-full bg-emerald-100/80 dark:bg-emerald-900/50 flex items-center justify-center shrink-0 group-hover:bg-emerald-200/80 dark:group-hover:bg-emerald-800/60 transition-colors duration-300">
                                                            <Check size={12} className="text-emerald-600 dark:text-emerald-400" />
                                                        </div>
                                                        {feature}
                                                    </div>
                                                ))}
                                            </div>

                                            <div className="mt-auto pt-6 border-t border-white/60 dark:border-slate-700/50 relative">
                                                <div className="flex items-end gap-1 mb-4">
                                                    <span className="text-3xl font-bold text-emerald-600 dark:text-emerald-400 whitespace-nowrap">{tariff.price}<span className="whitespace-nowrap">‚ÇΩ</span></span>
                                                    <span className="text-slate-400 text-sm mb-1">/ –º–µ—Å</span>
                                                </div>
                                                <Button primary className="w-full justify-center" onClick={() => { trackGoal('select_tariff'); window.openAIWidget && window.openAIWidget(`–ü—Ä–∏–≤–µ—Ç, —è —Ö–æ—á—É –ø–æ–¥–∫–ª—é—á–∏—Ç—å –∏–Ω—Ç–µ—Ä–Ω–µ—Ç –¥–ª—è ${activeTab === 'house' ? '–¥–æ–º–∞' : '–±–∏–∑–Ω–µ—Å–∞'} —Ç–∞—Ä–∏—Ñ ¬´${tariff.name}¬ª`); }}>
                                                    –ü–æ–¥–∫–ª—é—á–∏—Ç—å
                                                </Button>
                                            </div>
                                        </GlassCard>
                                    ))}
                                </div>

                                {activeTab === 'house' && (
                                    <div className="mt-8 p-6 bg-emerald-50/50 dark:bg-emerald-900/20 rounded-2xl border border-emerald-100 dark:border-emerald-800 text-center text-emerald-800 dark:text-emerald-300 animate-in fade-in duration-700">
                                        <p className="font-semibold">üè† –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —á–∞—Å—Ç–Ω–æ–≥–æ —Å–µ–∫—Ç–æ—Ä–∞ –æ—Ç 10 000<span className="whitespace-nowrap">‚ÇΩ</span> (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –º–æ–Ω—Ç–∞–∂–∞)</p>
                                    </div>
                                )}
                            </div>
                        </section>

                        {/* BUSINESS SECTION */}
                        <section className="py-20 px-4 gsap-section">
                            <div className="container mx-auto max-w-6xl">
                                <div className="bg-slate-900 rounded-3xl p-8 md:p-12 md:pb-0 overflow-hidden relative shadow-2xl">
                                     {/* Decorative Background */}
                                     <div className="absolute top-0 right-0 w-full h-full opacity-10" style={{backgroundImage: "url('https://www.transparenttextures.com/patterns/cubes.png')"}}></div>
                                     <div className="absolute -top-24 -right-24 w-96 h-96 bg-emerald-500/20 blur-[100px] rounded-full"></div>
                                     <div className="absolute -bottom-24 -left-24 w-96 h-96 bg-blue-500/20 blur-[100px] rounded-full"></div>
                        
                                     <div className="relative z-10 grid md:grid-cols-2 gap-12 items-end">
                                         {/* Left: Image */}
                                         <div className="flex justify-center h-full items-end relative">
                                             <img 
                                                 ref={bizRobotRef}
                                                 src="https://storage.googleapis.com/uspeshnyy-projects/smit/smit34.ru/smitrobot-biz.png" 
                                                 alt="SMIT –¥–ª—è –±–∏–∑–Ω–µ—Å–∞" 
                                                 className="w-full max-w-sm object-cover rounded-t-3xl drop-shadow-2xl origin-bottom"
                                                 style={{transformStyle: 'preserve-3d'}}
                                             />
                                             {/* Gradient Overlay for Mobile */}
                                             <div className="absolute bottom-0 left-0 w-full h-32 bg-gradient-to-t from-slate-900 to-transparent md:hidden"></div>
                                         </div>
                        
                                         {/* Right: Content */}
                                         <div className="text-white pb-8 md:pb-12 -mt-24 md:mt-0 relative z-10">
                                             <Badge>SMIT –ë–∏–∑–Ω–µ—Å</Badge>
                                             <h2 className="text-3xl md:text-4xl font-bold mb-6 mt-4">–í—ã—Å–æ–∫–æ—Å–∫–æ—Ä–æ—Å—Ç–Ω–æ–π –∏–Ω—Ç–µ—Ä–Ω–µ—Ç –¥–ª—è –≤–∞—à–µ–≥–æ –¥–µ–ª–∞</h2>
                                             
                                             <div className="space-y-6 mb-8">
                                                 <div className="flex items-start gap-4">
                                                      <div className="p-3 bg-emerald-500/20 rounded-xl text-emerald-400 shrink-0">
                                                         <Zap size={24} />
                                                      </div>
                                                      <div>
                                                         <h4 className="text-lg font-bold">–°–∫–æ—Ä–æ—Å—Ç—å –¥–æ 100 –ú–±–∏—Ç/—Å</h4>
                                                         <p className="text-slate-400 text-sm">–°—Ç–∞–±–∏–ª—å–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å –¥–ª—è —Ä–∞–±–æ—Ç—ã –æ—Ñ–∏—Å–∞</p>
                                                      </div>
                                                 </div>
                        
                                                 <div className="flex items-start gap-4">
                                                      <div className="p-3 bg-blue-500/20 rounded-xl text-blue-400 shrink-0">
                                                         <Server size={24} />
                                                      </div>
                                                      <div>
                                                         <h4 className="text-lg font-bold">–í—ã–¥–µ–ª–µ–Ω–Ω–∞—è –ª–∏–Ω–∏—è & SLA</h4>
                                                         <p className="text-slate-400 text-sm">–ì–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —Å–µ—Ä–≤–∏—Å–∞</p>
                                                      </div>
                                                 </div>
                        
                                                 <div className="flex items-start gap-4">
                                                      <div className="p-3 bg-purple-500/20 rounded-xl text-purple-400 shrink-0">
                                                         <CreditCard size={24} />
                                                      </div>
                                                      <div>
                                                         <h4 className="text-lg font-bold">–æ—Ç 1 990* <span className="whitespace-nowrap">‚ÇΩ</span>/–º–µ—Å</h4>
                                                         <p className="text-slate-400 text-sm">*—Ü–µ–Ω–∞ –∑–∞ 5 –ú–±–∏—Ç/—Å</p>
                                                      </div>
                                                 </div>
                                             </div>
                        
                                             <div className="flex flex-col sm:flex-row gap-4 items-center pt-4 border-t border-white/10">
                                                 <div className="text-center sm:text-left">
                                                     <span className="text-sm text-slate-400 block mb-1">–û—Ç–¥–µ–ª –ø–æ —Ä–∞–±–æ—Ç–µ —Å —é—Ä. –ª–∏—Ü–∞–º–∏</span>
                                                     <a href="tel:554035" className="text-2xl font-bold hover:text-emerald-400 transition-colors">55-40-35</a>
                                                 </div>
                                                 <Button primary className="w-full sm:w-auto ml-auto" onClick={() => window.openAIWidget && window.openAIWidget('–ü—Ä–∏–≤–µ—Ç, —è —Ö–æ—á—É –ø–æ–¥–∫–ª—é—á–∏—Ç—å –∏–Ω—Ç–µ—Ä–Ω–µ—Ç –¥–ª—è –±–∏–∑–Ω–µ—Å–∞, —Ä–∞—Å—Å–∫–∞–∂–∏ –∫–∞–∫–∏–µ —É—Å–ª–æ–≤–∏—è?')}>
                                                     –ü–æ–¥–∫–ª—é—á–∏—Ç—å –æ—Ñ–∏—Å
                                                 </Button>
                                             </div>
                                         </div>
                                     </div>
                                </div>
                            </div>
                        </section>

                        {/* SERVICES SECTION */}
                        <section id="services" className="py-20 bg-white/40 dark:bg-slate-900/40 backdrop-blur-sm border-y border-white/50 dark:border-slate-800 gsap-section">
                            <div className="container mx-auto max-w-6xl px-4">
                                <div className="mb-12">
                                    <Badge>–≠–∫–æ—Å–∏—Å—Ç–µ–º–∞</Badge>
                                    <h2 className="text-4xl font-bold mt-2 text-slate-900 dark:text-white">–ë–æ–ª—å—à–µ —á–µ–º –∏–Ω—Ç–µ—Ä–Ω–µ—Ç</h2>
                                </div>

                                <div className="grid md:grid-cols-3 gap-6">
                                    <GlassCard 
                                        className="gsap-card group cursor-pointer hover:border-emerald-200 dark:hover:border-emerald-700" 
                                        animateIn 
                                        style={{animationDelay: '0s'}}
                                        onClick={() => setActiveService('tv')}
                                    >
                                        <div className="w-12 h-12 bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400 rounded-xl flex items-center justify-center mb-4 group-hover:scale-110 transition-transform">
                                            <Monitor size={24} />
                                        </div>
                                        <h3 className="text-xl font-bold mb-2">–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ –¢–í</h3>
                                        <p className="text-slate-500 dark:text-slate-400 text-sm mb-4">–ë–æ–ª–µ–µ 200 –∫–∞–Ω–∞–ª–æ–≤ –≤ HD –∫–∞—á–µ—Å—Ç–≤–µ. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —ç—Ñ–∏—Ä–æ–º: –ø–∞—É–∑–∞, –ø–µ—Ä–µ–º–æ—Ç–∫–∞, –∞—Ä—Ö–∏–≤ –ø–µ—Ä–µ–¥–∞—á –∑–∞ 7 –¥–Ω–µ–π.</p>
                                        <span className="text-blue-600 dark:text-blue-400 font-semibold text-sm flex items-center gap-1 group-hover:gap-2 transition-all">–ü–æ–¥—Ä–æ–±–Ω–µ–µ <ArrowRight size={14}/></span>
                                    </GlassCard>

                                    <GlassCard 
                                        className="gsap-card group cursor-pointer hover:border-emerald-200 dark:hover:border-emerald-700" 
                                        animateIn 
                                        style={{animationDelay: '0.1s'}}
                                        onClick={() => setActiveService('cctv')}
                                    >
                                        <div className="w-12 h-12 bg-purple-100 dark:bg-purple-900/30 text-purple-600 dark:text-purple-400 rounded-xl flex items-center justify-center mb-4 group-hover:scale-110 transition-transform">
                                            <Shield size={24} />
                                        </div>
                                        <h3 className="text-xl font-bold mb-2">–í–∏–¥–µ–æ–Ω–∞–±–ª—é–¥–µ–Ω–∏–µ</h3>
                                        <p className="text-slate-500 dark:text-slate-400 text-sm mb-4">–í–∞—à –¥–æ–º –ø–æ–¥ –ø—Ä–∏—Å–º–æ—Ç—Ä–æ–º 24/7. –î–æ—Å—Ç—É–ø –∫ –∫–∞–º–µ—Ä–∞–º —Å–æ —Å–º–∞—Ä—Ç—Ñ–æ–Ω–∞, –æ–±–ª–∞—á–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –∑–∞–ø–∏—Å–µ–π.</p>
                                        <span className="text-purple-600 dark:text-purple-400 font-semibold text-sm flex items-center gap-1 group-hover:gap-2 transition-all">–ü–æ–¥–æ–±—Ä–∞—Ç—å –∫–∞–º–µ—Ä—ã <ArrowRight size={14}/></span>
                                    </GlassCard>

                                    <GlassCard 
                                        className="gsap-card group cursor-pointer hover:border-emerald-200 dark:hover:border-emerald-700" 
                                        animateIn 
                                        style={{animationDelay: '0.2s'}}
                                        onClick={() => setActiveService('pc')}
                                    >
                                        <div className="w-12 h-12 bg-orange-100 dark:bg-orange-900/30 text-orange-600 dark:text-orange-400 rounded-xl flex items-center justify-center mb-4 group-hover:scale-110 transition-transform">
                                            <Zap size={24} />
                                        </div>
                                        <h3 className="text-xl font-bold mb-2">–ö–æ–º–ø—å—é—Ç–µ—Ä–Ω—ã–π —Å–µ—Ä–≤–∏—Å</h3>
                                        <p className="text-slate-500 dark:text-slate-400 text-sm mb-4">–†–µ–º–æ–Ω—Ç –ü–ö, –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–æ—É—Ç–µ—Ä–æ–≤, —É–¥–∞–ª–µ–Ω–∏–µ –≤–∏—Ä—É—Å–æ–≤. –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–∞—è –ø–æ–º–æ—â—å –æ—Ç –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞.</p>
                                        <span className="text-orange-600 dark:text-orange-400 font-semibold text-sm flex items-center gap-1 group-hover:gap-2 transition-all">–ü—Ä–∞–π—Å-–ª–∏—Å—Ç <ArrowRight size={14}/></span>
                                    </GlassCard>
                                </div>
                            </div>
                        </section>

                        {/* EQUIPMENT */}
                        <section className="py-20 px-4 gsap-section relative overflow-hidden">
                            {/* Robot background ‚Äî positioned at section level */}
                            <div className="absolute right-[2%] top-1/2 -translate-y-[45%] h-[90%] pointer-events-none select-none hidden md:block" style={{zIndex: 1}}>
                                <div className="relative h-full">
                                    <div className="absolute inset-0 bg-emerald-400/20 blur-[100px] rounded-full animate-pulse scale-125"></div>
                                    <img
                                        src="https://storage.googleapis.com/uspeshnyy-projects/smit/smit34.ru/smitrobot_tv.png"
                                        alt=""
                                        className="h-full w-auto object-contain animate-float drop-shadow-2xl relative"
                                    />
                                </div>
                            </div>

                            <div className="container mx-auto max-w-6xl relative z-10">
                                <div className="flex flex-col md:flex-row md:items-end justify-between mb-10 gap-4">
                                    <div>
                                        <h2 className="text-3xl font-bold text-slate-900 dark:text-white">–û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ</h2>
                                        <p className="text-slate-500 dark:text-slate-400">–ù–∞–¥–µ–∂–Ω—ã–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —Å–∫–æ—Ä–æ—Å—Ç–∏</p>
                                    </div>
                                </div>

                                <div className="grid md:grid-cols-3 gap-6 items-center">
                                    <GlassCard className="gsap-card flex items-center gap-6 backdrop-blur-md bg-white/70 dark:bg-slate-800/60 border border-white/80 dark:border-slate-700/40 shadow-xl relative z-10" animateIn style={{animationDelay: '0s'}}>
                                        <div className="w-24 h-24 bg-white/60 dark:bg-slate-700/40 rounded-lg flex items-center justify-center shrink-0 backdrop-blur-sm">
                                            <Wifi size={40} className="text-slate-400 dark:text-slate-300" />
                                        </div>
                                        <div>
                                            <h4 className="text-xl font-bold mb-1">–û–¥–Ω–æ–¥–∏–∞–ø–∞–∑–æ–Ω–Ω—ã–π —Ä–æ—É—Ç–µ—Ä</h4>
                                            <p className="text-sm text-slate-500 dark:text-slate-400 mb-2">Wi-Fi 2.4GHz. –ë–∞–∑–æ–≤–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ.</p>
                                            <div className="flex items-center gap-4">
                                                <span className="font-bold text-emerald-600 dark:text-emerald-400">3 500 <span className="whitespace-nowrap">‚ÇΩ</span></span>
                                                <span className="text-xs bg-emerald-100/80 dark:bg-emerald-900/30 text-emerald-700 dark:text-emerald-400 px-2 py-1 rounded backdrop-blur-sm">–†–∞—Å—Å—Ä–æ—á–∫–∞</span>
                                            </div>
                                        </div>
                                    </GlassCard>

                                    <GlassCard className="gsap-card flex items-center gap-6 backdrop-blur-md bg-white/70 dark:bg-slate-800/60 border border-white/80 dark:border-slate-700/40 shadow-xl relative z-10" animateIn style={{animationDelay: '0.05s'}}>
                                        <div className="w-24 h-24 bg-white/60 dark:bg-slate-700/40 rounded-lg flex items-center justify-center shrink-0 backdrop-blur-sm">
                                            <Wifi size={40} className="text-slate-400 dark:text-slate-300" />
                                        </div>
                                        <div>
                                            <h4 className="text-xl font-bold mb-1">–ì–∏–≥–∞–±–∏—Ç–Ω—ã–π, –¥–≤—É—Ö–¥–∏–∞–ø–∞–∑–æ–Ω–Ω—ã–π —Ä–æ—É—Ç–µ—Ä</h4>
                                            <p className="text-sm text-slate-500 dark:text-slate-400 mb-2">Wi-Fi 5GHz + 2.4GHz. –ì–∏–≥–∞–±–∏—Ç–Ω—ã–µ –ø–æ—Ä—Ç—ã.</p>
                                            <div className="flex items-center gap-4">
                                                <span className="font-bold text-emerald-600 dark:text-emerald-400">4 500 <span className="whitespace-nowrap">‚ÇΩ</span></span>
                                                <span className="text-xs bg-emerald-100/80 dark:bg-emerald-900/30 text-emerald-700 dark:text-emerald-400 px-2 py-1 rounded backdrop-blur-sm">–†–∞—Å—Å—Ä–æ—á–∫–∞</span>
                                            </div>
                                        </div>
                                    </GlassCard>

                                    <GlassCard className="gsap-card flex items-center gap-6 backdrop-blur-md bg-white/70 dark:bg-slate-800/60 border border-white/80 dark:border-slate-700/40 shadow-xl relative z-10" animateIn style={{animationDelay: '0.1s'}}>
                                        <div className="w-24 h-24 bg-white/60 dark:bg-slate-700/40 rounded-lg flex items-center justify-center shrink-0 backdrop-blur-sm">
                                            <Monitor size={40} className="text-slate-400 dark:text-slate-300" />
                                        </div>
                                        <div>
                                            <h4 className="text-xl font-bold mb-1">–¢–í-–ü—Ä–∏—Å—Ç–∞–≤–∫–∞ 4K</h4>
                                            <p className="text-sm text-slate-500 dark:text-slate-400 mb-2">Android TV, YouTube, –ö–∏–Ω–æ—Ç–µ–∞—Ç—Ä—ã.</p>
                                            <div className="flex items-center gap-4">
                                                <span className="font-bold text-emerald-600 dark:text-emerald-400">4 200 <span className="whitespace-nowrap">‚ÇΩ</span></span>
                                            </div>
                                        </div>
                                    </GlassCard>
                                </div>
                            </div>
                        </section>

                        {/* SUPPORT & HELP */}
                        <section id="help" className="py-20 bg-slate-900 text-white relative overflow-hidden gsap-section">
                             {/* Decorative Background Pattern */}
                            <div className="absolute top-0 right-0 w-full h-full opacity-5 pointer-events-none" style={{backgroundImage: "url('https://www.transparenttextures.com/patterns/cubes.png')"}}></div>

                            <div className="container mx-auto max-w-6xl relative z-10 px-4">
                                <div className="grid lg:grid-cols-2 gap-12 items-center">
                                    
                                    {/* LEFT SIDE: Content + Contacts */}
                                    <div className="gsap-card">
                                        <Badge>–ü–æ–¥–¥–µ—Ä–∂–∫–∞</Badge>
                                        <h2 className="text-4xl font-bold mt-2 mb-6">–ü–æ–º–æ—â—å –∞–±–æ–Ω–µ–Ω—Ç—É</h2>
                                        <p className="text-slate-300 mb-8 text-lg">
                                            –ú—ã —Å–æ–±—Ä–∞–ª–∏ –≤—Å—ë –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–µ, —á—Ç–æ–±—ã –≤—ã –º–æ–≥–ª–∏ —Ä–µ—à–∏—Ç—å –≤–æ–ø—Ä–æ—Å —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ –∏ –±—ã—Å—Ç—Ä–æ.
                                        </p>
                                        
                                        {/* Help Buttons */}
                                        <div className="grid sm:grid-cols-2 gap-4 mb-10">
                                            <button 
                                                className="flex items-center gap-3 p-4 bg-white/10 hover:bg-white/20 rounded-xl transition-colors text-left border border-white/10"
                                                onClick={() => setShowSpeedtestModal(true)}
                                            >
                                                <div className="p-2 bg-emerald-500 rounded-lg"><Zap size={20} /></div>
                                                <div>
                                                    <div className="font-bold">Speedtest</div>
                                                    <div className="text-xs text-slate-400">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–∫–æ—Ä–æ—Å—Ç—å</div>
                                                </div>
                                            </button>
                                            <button 
                                                className="flex items-center gap-3 p-4 bg-white/10 hover:bg-white/20 rounded-xl transition-colors text-left border border-white/10"
                                                onClick={() => setActiveService('documents')}
                                            >
                                                <div className="p-2 bg-teal-500 rounded-lg"><FileText size={20} /></div>
                                                <div>
                                                    <div className="font-bold">–î–æ–∫—É–º–µ–Ω—Ç—ã</div>
                                                    <div className="text-xs text-slate-400">–û—Ñ–µ—Ä—Ç—ã –∏ —Ä–µ–≥–ª–∞–º–µ–Ω—Ç—ã</div>
                                                </div>
                                            </button>
                                            <button 
                                                className="flex items-center gap-3 p-4 bg-white/10 hover:bg-white/20 rounded-xl transition-colors text-left border border-white/10"
                                                onClick={() => setActiveService('instructions')}
                                            >
                                                <div className="p-2 bg-orange-500 rounded-lg"><Settings size={20} /></div>
                                                <div>
                                                    <div className="font-bold">–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏</div>
                                                </div>
                                            </button>
                                            <button 
                                                className="flex items-center gap-3 p-4 bg-white/10 hover:bg-white/20 rounded-xl transition-colors text-left border border-white/10"
                                                onClick={() => setActiveService('payment')}
                                            >
                                                <div className="p-2 bg-purple-500 rounded-lg"><CreditCard size={20} /></div>
                                                <div>
                                                    <div className="font-bold">–û–ø–ª–∞—Ç–∞</div>
                                                    <div className="text-xs text-slate-400">–°–ø–æ—Å–æ–±—ã –æ–ø–ª–∞—Ç—ã</div>
                                                </div>
                                            </button>
                                        </div>

                                        {/* Moved Contact Info */}
                                        <div className="border-t border-white/10 pt-8">
                                            <div className="flex flex-col md:flex-row justify-between items-start gap-6">
                                                <div>
                                                    <h3 className="text-2xl font-bold mb-2">–ù–µ –Ω–∞—à–ª–∏ –æ—Ç–≤–µ—Ç?</h3>
                                                    <p className="text-slate-300 mb-4">–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∫–ª–∏–µ–Ω—Ç–æ–≤ —Å 09:00 –¥–æ 21:00</p>
                                                </div>
                                                <Button 
                                                    className="bg-gradient-to-r from-purple-600 to-indigo-600 text-white shadow-lg shadow-purple-500/30 hover:scale-105 border-none whitespace-nowrap"
                                                    onClick={() => window.openAIWidget && window.openAIWidget()}
                                                >
                                                    <Bot size={20} /> –°–ø—Ä–æ—Å–∏—Ç—å —É AI
                                                </Button>
                                            </div>
                                            <div className="flex flex-col sm:flex-row gap-6 mt-6">
                                                <div>
                                                    <a href="tel:+79375551122" className="text-3xl font-bold text-emerald-400 hover:text-emerald-300 transition-colors whitespace-nowrap block mb-3">
                                                        +7 (937) 555-11-22
                                                    </a>
                                                    <div className="flex items-center gap-4">
                                                        <div className="flex items-center gap-2 text-slate-400 text-sm">
                                                            <Mail size={14} />
                                                            <a href="mailto:ask@support.smit34.ru" className="hover:text-emerald-400 transition-colors">ask@support.smit34.ru</a>
                                                        </div>
                                                        <a href="https://t.me/smitsupport_bot" target="_blank" className="flex items-center gap-2 text-sky-400 hover:text-sky-300 transition-colors text-sm">
                                                            <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="22" x2="11" y1="2" y2="13"/><polygon points="22 2 15 22 11 13 2 9 22 2"/></svg>
                                                            Telegram
                                                        </a>
                                                        <a href="https://vk.com/im/convo/-214756373?entrypoint=list_all&rp=peer-214756373" target="_blank" className="flex items-center gap-2 text-blue-400 hover:text-blue-300 transition-colors text-sm">
                                                            <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M15 22.5h-5c-6.5 0-7.5-5-7.5-9s1-9 7.5-9h5c6.5 0 7.5 5 7.5 9s-1 9-7.5 9z"/><path d="M17.5 8c.5.5 1 2 1 4s-.5 3.5-1 4"/><path d="M14.5 12h-5"/></svg>
                                                            –ù–∞–ø–∏—Å–∞—Ç—å –≤ VK
                                                        </a>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    {/* RIGHT SIDE: Robot Illustration */}
                                    <div className="relative flex justify-center gsap-card">
                                         {/* Background Glow */}
                                         <div className="absolute inset-0 bg-emerald-500/20 blur-[80px] rounded-full pointer-events-none transform translate-y-10"></div>
                                         
                                         <img 
                                            src="https://storage.googleapis.com/uspeshnyy-projects/smit/smit34.ru/smitrobot_help.png" 
                                            alt="–†–æ–±–æ—Ç –ø–æ–¥–¥–µ—Ä–∂–∫–∏ SMIT" 
                                            className="relative w-full max-w-md object-cover rounded-3xl animate-float drop-shadow-2xl z-10"
                                         />
                                    </div>

                                </div>
                            </div>
                        </section>

                        {/* ABOUT & MAP */}
                        <section className="pt-20 pb-48 px-4 gsap-section relative overflow-hidden">
                            {/* Video Background ‚Äî Light theme */}
                            <video
                                autoPlay muted loop playsInline
                                className="absolute inset-0 w-full h-full object-cover object-top pointer-events-none dark:hidden"
                                src="https://storage.googleapis.com/uspeshnyy-projects/smit/smit34.ru/smitcrystal_bg.MP4"
                            />
                            {/* Video Background ‚Äî Dark theme */}
                            <video
                                autoPlay muted loop playsInline
                                className="absolute inset-0 w-full h-full object-cover object-top pointer-events-none hidden dark:block"
                                src="https://storage.googleapis.com/uspeshnyy-projects/smit/smit34.ru/smitcrystal_bg_dark.MP4"
                            />
                            {/* Gradient overlay light: edges solid ‚Üí transparent center */}
                            <div className="absolute inset-0 pointer-events-none dark:hidden"
                                style={{background: 'linear-gradient(to bottom, #f8fafc 0%, transparent 22%, transparent 68%, #f8fafc 100%)'}}
                            />
                            {/* Gradient overlay dark */}
                            <div className="absolute inset-0 pointer-events-none hidden dark:block"
                                style={{background: 'linear-gradient(to bottom, #020617 0%, transparent 22%, transparent 68%, #020617 100%)'}}
                            />
                            <div className="container mx-auto max-w-6xl relative z-10">
                                <div className="grid md:grid-cols-2 gap-12 items-center">
                                    <div>
                                        <h2 className="text-3xl font-bold mb-6 text-slate-900 dark:text-white">SmIT ‚Äî —Ç–≤–æ–π –º–µ—Å—Ç–Ω—ã–π –æ–ø–µ—Ä–∞—Ç–æ—Ä</h2>
                                        <div className="space-y-4 text-slate-600 dark:text-slate-300 leading-relaxed">
                                            <p>
                                                –ú—ã —Ä–∞–±–æ—Ç–∞–µ–º –≤ –ö—Ä–∞—Å–Ω–æ–∞—Ä–º–µ–π—Å–∫–æ–º —Ä–∞–π–æ–Ω–µ —É–∂–µ –±–æ–ª–µ–µ 10 –ª–µ—Ç. –í –æ—Ç–ª–∏—á–∏–µ –æ—Ç —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã—Ö –≥–∏–≥–∞–Ω—Ç–æ–≤, –º—ã —Ä—è–¥–æ–º. 
                                                –ù–∞—à –æ—Ñ–∏—Å –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –Ω–∞ —É–ª–∏—Ü–µ 40 –ª–µ—Ç –í–õ–ö–°–ú, –∞ –∏–Ω–∂–µ–Ω–µ—Ä—ã –∑–Ω–∞—é—Ç –∫–∞–∂–¥—ã–π –¥–æ–º —Ä–∞–π–æ–Ω–∞.
                                            </p>
                                            <p>
                                                –ú—ã —Å—Ç—Ä–æ–∏–º —Å–≤–æ–∏ —Å–µ—Ç–∏ —Å –∑–∞–ø–∞—Å–æ–º –ø—Ä–æ—á–Ω–æ—Å—Ç–∏, –∏—Å–ø–æ–ª—å–∑—É–µ–º —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–µ –æ–ø—Ç–æ–≤–æ–ª–æ–∫–Ω–æ –∏ —Ä–µ–∞–≥–∏—Ä—É–µ–º –Ω–∞ –∑–∞—è–≤–∫–∏ –≤ –¥–µ–Ω—å –æ–±—Ä–∞—â–µ–Ω–∏—è.
                                            </p>
                                        </div>
                                        <div className="mt-8 grid grid-cols-2 gap-4">
                                            <div className="p-4 bg-emerald-50 dark:bg-emerald-900/20 rounded-xl border border-emerald-100 dark:border-emerald-800">
                                                <div className="font-bold text-3xl text-emerald-600 dark:text-emerald-400 mb-1">10+</div>
                                                <div className="text-sm text-slate-500 dark:text-slate-400">–õ–µ—Ç –Ω–∞ —Ä—ã–Ω–∫–µ</div>
                                            </div>
                                            <div className="p-4 bg-emerald-50 dark:bg-emerald-900/20 rounded-xl border border-emerald-100 dark:border-emerald-800">
                                                <div className="font-bold text-3xl text-emerald-600 dark:text-emerald-400 mb-1">GPON</div>
                                                <div className="text-sm text-slate-500 dark:text-slate-400">–¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è –±—É–¥—É—â–µ–≥–æ</div>
                                            </div>
                                        </div>
                                    </div>
                                    <div 
                                        className="h-80 bg-slate-200 dark:bg-slate-700 rounded-3xl overflow-hidden relative shadow-inner cursor-pointer group"
                                        onClick={() => setShowMapModal(true)}
                                    >
                                        {/* Background Image */}
                                        <div className="absolute inset-0 bg-cover bg-center transition-transform duration-700 group-hover:scale-110" style={{backgroundImage: "url('https://storage.googleapis.com/uspeshnyy-projects/smit/smit34.ru/map.png')"}}></div>
                                        
                                        {/* Overlay content */}
                                        <div className="absolute inset-0 bg-slate-900/30 group-hover:bg-slate-900/20 transition-colors flex items-center justify-center">
                                            <div className="text-center bg-white/90 dark:bg-slate-800/90 backdrop-blur-sm p-4 rounded-2xl shadow-lg">
                                                <MapPin size={48} className="mx-auto text-emerald-600 dark:text-emerald-400 mb-2" />
                                                <span className="text-slate-800 dark:text-white font-bold block">–ö–∞—Ä—Ç–∞ –ø–æ–∫—Ä—ã—Ç–∏—è</span>
                                                <span className="text-slate-500 dark:text-slate-300 text-sm">–ù–∞–∂–º–∏—Ç–µ, —á—Ç–æ–±—ã –æ—Ç–∫—Ä—ã—Ç—å</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </section>

                        {/* MAP MODAL */}
                        {showMapModal && (
                            <div className="fixed inset-0 z-[100] bg-black/90 flex items-center justify-center p-4 animate-in fade-in duration-300">
                                <button 
                                    className="absolute top-3 right-3 w-11 h-11 flex items-center justify-center rounded-full bg-white/10 hover:bg-white/20 text-white hover:text-emerald-400 transition-colors z-[101]"
                                    onClick={() => setShowMapModal(false)}
                                >
                                    <X size={32} />
                                </button>
                                <div className="w-full h-full max-w-7xl max-h-[90vh] bg-white dark:bg-slate-800 rounded-2xl overflow-hidden relative">
                                    <iframe 
                                        src="https://yandex.ru/map-widget/v1/?ll=44.634437%2C48.465393&mode=usermaps&source=constructorLink&um=constructor%3Af90d9a43df4e905f6d7799d37dfeaec94d1cc23668fac40495a6fb80db623c6d&z=11" 
                                        width="100%" 
                                        height="100%" 
                                        frameBorder="0"
                                        allowFullScreen={true}
                                        className="absolute inset-0 w-full h-full"
                                    ></iframe>
                                </div>
                            </div>
                        )}

                        {/* SPEEDTEST MODAL */}
                        {showSpeedtestModal && (
                            <div className="fixed inset-0 z-[100] bg-black/90 flex items-center justify-center p-4 animate-in fade-in duration-300">
                                <button 
                                    className="absolute top-3 right-3 w-11 h-11 flex items-center justify-center rounded-full bg-white/10 hover:bg-white/20 text-white hover:text-emerald-400 transition-colors z-[101]"
                                    onClick={() => setShowSpeedtestModal(false)}
                                >
                                    <X size={32} />
                                </button>
                                
                                <div className="w-full h-full max-w-7xl max-h-[90vh] bg-white dark:bg-slate-900 rounded-2xl overflow-hidden relative flex flex-col">
                                    <div className="flex bg-slate-50 dark:bg-slate-800 border-b border-slate-200 dark:border-slate-700">
                                        <button 
                                            onClick={() => setActiveSpeedtestTab('yandex')}
                                            className={`flex-1 p-4 font-bold text-center transition-colors ${activeSpeedtestTab === 'yandex' ? 'bg-white dark:bg-slate-900 text-emerald-600 dark:text-emerald-400 border-b-2 border-emerald-500' : 'text-slate-500 dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-700 hover:text-slate-700 dark:hover:text-slate-200'}`}
                                        >
                                            –Ø–Ω–¥–µ–∫—Å.–ò–Ω—Ç–µ—Ä–Ω–µ—Ç–æ–º–µ—Ç—Ä
                                        </button>
                                        <button 
                                            onClick={() => setActiveSpeedtestTab('rt')}
                                            className={`flex-1 p-4 font-bold text-center transition-colors ${activeSpeedtestTab === 'rt' ? 'bg-white dark:bg-slate-900 text-emerald-600 dark:text-emerald-400 border-b-2 border-emerald-500' : 'text-slate-500 dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-700 hover:text-slate-700 dark:hover:text-slate-200'}`}
                                        >
                                            –†–æ—Å—Ç–µ–ª–µ–∫–æ–º Speedtest
                                        </button>
                                    </div>
                                    
                                    <div className="flex-1 relative bg-slate-100 dark:bg-slate-950 flex items-center justify-center p-8">
                                        {activeSpeedtestTab === 'yandex' && (
                                            <div className="text-center max-w-md">
                                                <div className="mb-6 mx-auto w-24 h-24 bg-red-100 dark:bg-red-900/30 text-red-600 dark:text-red-400 rounded-full flex items-center justify-center">
                                                    <Zap size={48} />
                                                </div>
                                                <h3 className="text-2xl font-bold mb-4 text-slate-800 dark:text-white">–ò–∑–º–µ—Ä—å—Ç–µ —Å–∫–æ—Ä–æ—Å—Ç—å –Ω–∞ –Ø–Ω–¥–µ–∫—Å–µ</h3>
                                                <p className="text-slate-500 dark:text-slate-400 mb-8">–î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–æ—á–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ —Å–µ—Ä–≤–∏—Å –Ø–Ω–¥–µ–∫—Å.–ò–Ω—Ç–µ—Ä–Ω–µ—Ç–æ–º–µ—Ç—Ä. –≠—Ç–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ –∏ –±—ã—Å—Ç—Ä–æ.</p>
                                                <a 
                                                    href="https://yandex.ru/internet" 
                                                    target="_blank" 
                                                    rel="noopener noreferrer"
                                                    className="inline-flex items-center gap-2 bg-red-500 hover:bg-red-600 text-white font-bold py-3 px-8 rounded-xl transition-all shadow-lg hover:shadow-red-500/30 hover:-translate-y-1"
                                                >
                                                    –û—Ç–∫—Ä—ã—Ç—å –Ø–Ω–¥–µ–∫—Å.–ò–Ω—Ç–µ—Ä–Ω–µ—Ç–æ–º–µ—Ç—Ä <ArrowRight size={20} />
                                                </a>
                                            </div>
                                        )}
                                        {activeSpeedtestTab === 'rt' && (
                                            <div className="text-center max-w-md">
                                                <div className="mb-6 mx-auto w-24 h-24 bg-purple-100 dark:bg-purple-900/30 text-purple-600 dark:text-purple-400 rounded-full flex items-center justify-center">
                                                    <Zap size={48} />
                                                </div>
                                                <h3 className="text-2xl font-bold mb-4 text-slate-800 dark:text-white">–ò–∑–º–µ—Ä—å—Ç–µ —Å–∫–æ—Ä–æ—Å—Ç—å —á–µ—Ä–µ–∑ –†–æ—Å—Ç–µ–ª–µ–∫–æ–º</h3>
                                                <p className="text-slate-500 dark:text-slate-400 mb-8">–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–∏—Å –∑–∞–º–µ—Ä–∞ —Å–∫–æ—Ä–æ—Å—Ç–∏ –æ—Ç –†–æ—Å—Ç–µ–ª–µ–∫–æ–º –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è.</p>
                                                <a 
                                                    href="https://www.rt.ru/speedtest" 
                                                    target="_blank" 
                                                    rel="noopener noreferrer"
                                                    className="inline-flex items-center gap-2 bg-purple-600 hover:bg-purple-700 text-white font-bold py-3 px-8 rounded-xl transition-all shadow-lg hover:shadow-purple-500/30 hover:-translate-y-1"
                                                >
                                                    –û—Ç–∫—Ä—ã—Ç—å RT Speedtest <ArrowRight size={20} />
                                                </a>
                                            </div>
                                        )}
                                    </div>
                                </div>
                            </div>
                        )}

                        {/* FOOTER */}
                        <footer className="relative z-10 -mt-32 pt-16 pb-8 text-sm animate-in fade-in duration-700 fill-mode-backwards" style={{animationDelay: '1.2s'}}>
                            {/* Gradient: transparent top ‚Üí solid footer bottom */}
                            <div className="absolute inset-0 bg-gradient-to-b from-transparent via-slate-50/95 to-slate-50 dark:via-slate-900/95 dark:to-slate-900 pointer-events-none"></div>
                            <div className="container mx-auto max-w-6xl px-4 relative z-10">
                                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8 mb-12">
                                    {/* Col 1: Brand */}
                                    <div>
                                        <div className="flex items-center gap-2 mb-4">
                                            <div className="w-8 h-8 bg-emerald-600 rounded-md flex items-center justify-center text-white font-bold">S</div>
                                            <span className="text-xl font-bold text-slate-800 dark:text-white">SmIT</span>
                                        </div>
                                        <p className="text-slate-500 dark:text-slate-400 mb-4">¬© 2026 SmIT.<br/>–í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.</p>
                                        <div className="flex gap-4">
                                            {/* VK Icon */}
                                            <a href="https://vk.com/im/convo/-214756373?entrypoint=list_all&rp=peer-214756373" target="_blank" className="w-8 h-8 bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400 rounded-full hover:bg-blue-600 hover:text-white dark:hover:bg-blue-600 dark:hover:text-white transition-colors flex items-center justify-center">
                                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M15 22.5h-5c-6.5 0-7.5-5-7.5-9s1-9 7.5-9h5c6.5 0 7.5 5 7.5 9s-1 9-7.5 9z"/><path d="M17.5 8c.5.5 1 2 1 4s-.5 3.5-1 4"/><path d="M14.5 12h-5"/></svg>
                                            </a>
                                            {/* Telegram Icon */}
                                            <a href="https://t.me/smitsupport_bot" target="_blank" className="w-8 h-8 bg-sky-100 dark:bg-sky-900/30 text-sky-500 dark:text-sky-400 rounded-full hover:bg-sky-500 hover:text-white dark:hover:bg-sky-500 dark:hover:text-white transition-colors flex items-center justify-center">
                                                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="22" x2="11" y1="2" y2="13"/><polygon points="22 2 15 22 11 13 2 9 22 2"/></svg>
                                            </a>
                                             {/* Mail Icon */}
                                            <a href="mailto:ask@support.smit34.ru" className="w-8 h-8 bg-emerald-100 dark:bg-emerald-900/30 text-emerald-600 dark:text-emerald-400 rounded-full hover:bg-emerald-600 hover:text-white dark:hover:bg-emerald-600 dark:hover:text-white transition-colors flex items-center justify-center">
                                                <Mail size={16} />
                                            </a>
                                        </div>
                                    </div>

                                    {/* Col 2: Navigation */}
                                    <div>
                                        <h4 className="font-bold text-slate-900 dark:text-white mb-4">–ù–∞–≤–∏–≥–∞—Ü–∏—è</h4>
                                        <ul className="space-y-2">
                                            <li><a href="#tariffs" className="text-slate-600 dark:text-slate-400 hover:text-emerald-600 dark:hover:text-emerald-400 transition-colors">–¢–∞—Ä–∏—Ñ—ã</a></li>
                                            <li><a href="#services" className="text-slate-600 dark:text-slate-400 hover:text-emerald-600 dark:hover:text-emerald-400 transition-colors">–£—Å–ª—É–≥–∏</a></li>
                                            <li><a href="#help" className="text-slate-600 dark:text-slate-400 hover:text-emerald-600 dark:hover:text-emerald-400 transition-colors">–ü–æ–¥–¥–µ—Ä–∂–∫–∞</a></li>
                                            <li><a href="https://bill.smit34.ru" className="text-emerald-600 dark:text-emerald-400 font-medium hover:underline">–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç</a></li>
                                        </ul>
                                    </div>

                                    {/* Col 3: Documents */}
                                    <div>
                                        <h4 className="font-bold text-slate-900 dark:text-white mb-4">–î–æ–∫—É–º–µ–Ω—Ç—ã</h4>
                                        <ul className="space-y-2">
                                            <li>
                                                <button 
                                                    className="flex items-center gap-2 text-slate-600 dark:text-slate-400 hover:text-emerald-600 dark:hover:text-emerald-400 transition-colors text-left"
                                                    onClick={() => setLightboxOpen(true)}
                                                >
                                                    <FileText size={14} /> –õ–∏—Ü–µ–Ω–∑–∏–∏ –∏ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã
                                                </button>
                                            </li>
                                            <li>
                                                <button 
                                                    className="text-slate-600 dark:text-slate-400 hover:text-emerald-600 dark:hover:text-emerald-400 transition-colors text-left"
                                                    onClick={() => setActiveDoc('agreement')}
                                                >
                                                    –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–µ —Å–æ–≥–ª–∞—à–µ–Ω–∏–µ
                                                </button>
                                            </li>
                                            <li>
                                                <button 
                                                    className="text-slate-600 dark:text-slate-400 hover:text-emerald-600 dark:hover:text-emerald-400 transition-colors text-left mt-1"
                                                    onClick={() => setActiveDoc('privacy')}
                                                >
                                                    –ü–æ–ª–∏—Ç–∏–∫–∞ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏
                                                </button>
                                            </li>
                                            <li>
                                                <button 
                                                    className="text-slate-600 dark:text-slate-400 hover:text-emerald-600 dark:hover:text-emerald-400 transition-colors text-left"
                                                    onClick={() => setActiveService('documents')}
                                                >
                                                    –†–µ–≥–ª–∞–º–µ–Ω—Ç—ã –∏ —É—Å–ª–æ–≤–∏—è
                                                </button>
                                            </li>
                                            <li className="text-slate-400 dark:text-slate-500 mt-4 text-xs">
                                                –û–û–û ¬´–°–º–∏—Ç¬ª<br/>–ò–ù–ù 3461009378<br/>–û–ì–†–ù 1143443002273
                                            </li>
                                        </ul>
                                    </div>

                                    {/* Col 4: Contacts */}
                                    <div>
                                        <h4 className="font-bold text-slate-900 dark:text-white mb-4">–ö–æ–Ω—Ç–∞–∫—Ç—ã</h4>
                                        <ul className="space-y-3">
                                            <li className="flex items-start gap-3 text-slate-600 dark:text-slate-400">
                                                <MapPin size={16} className="mt-1 shrink-0 text-emerald-600 dark:text-emerald-400" />
                                                <span>–≥. –í–æ–ª–≥–æ–≥—Ä–∞–¥,<br/>—É–ª. 40 –ª–µ—Ç –í–õ–ö–°–ú, –¥. 80, –æ—Ñ. 1</span>
                                            </li>
                                            <li className="flex items-start gap-3 text-slate-600 dark:text-slate-400">
                                                <Phone size={16} className="mt-1 shrink-0 text-emerald-600 dark:text-emerald-400" />
                                                <div className="flex flex-col">
                                                    <a href="tel:+79375551122" className="hover:text-emerald-600 dark:hover:text-emerald-400 font-medium">+7 (937) 555-11-22</a>
                                                    <span className="text-xs text-slate-400 dark:text-slate-500">–¢–µ–ª–µ—Ñ–æ–Ω –¥–ª—è —Ñ–∏–∑–∏—á–µ—Å–∫–∏—Ö –ª–∏—Ü</span>
                                                </div>
                                            </li>
                                            <li className="flex items-start gap-3 text-slate-600 dark:text-slate-400">
                                                <Phone size={16} className="mt-1 shrink-0 text-emerald-600 dark:text-emerald-400" />
                                                <div className="flex flex-col">
                                                    <a href="tel:554035" className="hover:text-emerald-600 dark:hover:text-emerald-400 font-medium">55-40-35</a>
                                                    <span className="text-xs text-slate-400 dark:text-slate-500">–¢–µ–ª–µ—Ñ–æ–Ω –¥–ª—è —é—Ä–∏–¥–∏—á–µ—Å–∫–∏—Ö –ª–∏—Ü</span>
                                                </div>
                                            </li>
                                            <li className="flex items-center gap-3 text-slate-600 dark:text-slate-400">
                                                <Mail size={16} className="text-emerald-600 dark:text-emerald-400" />
                                                <a href="mailto:ask@support.smit34.ru" className="hover:text-emerald-600 dark:hover:text-emerald-400">ask@support.smit34.ru</a>
                                            </li>
                                            <li className="flex items-center gap-3 text-slate-600 dark:text-slate-400">
                                                <Clock size={16} className="text-emerald-600 dark:text-emerald-400" />
                                                <span>–ü–Ω-–í—Å: 09:00 - 21:00</span>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </footer>

                        {/* LIGHTBOX FOR LICENSES */}
                        {lightboxOpen && (
                            <div className="fixed inset-0 z-[90] flex items-center justify-center p-4 bg-black/90 backdrop-blur-md animate-in fade-in duration-300"
                                onTouchStart={onTouchStart}
                                onTouchMove={onTouchMove}
                                onTouchEnd={onTouchEnd}
                            >
                                <button 
                                    className="absolute top-3 right-3 w-11 h-11 flex items-center justify-center rounded-full bg-white/10 hover:bg-white/20 text-white hover:text-emerald-400 transition-colors z-[92]"
                                    onClick={() => setLightboxOpen(false)}
                                >
                                    <X size={32} />
                                </button>
                                
                                <button 
                                    className="hidden md:block absolute left-4 top-1/2 -translate-y-1/2 text-white/50 hover:text-white transition-colors z-[91] p-2" 
                                    onClick={prevLicense}
                                >
                                     <ChevronLeft size={48} />
                                </button>

                                <div className="relative max-w-full max-h-[85vh]">
                                    <img 
                                        src={licenses[currentLicenseIndex]} 
                                        alt={`License ${currentLicenseIndex + 1}`} 
                                        className="max-w-full max-h-[85vh] object-contain rounded-lg shadow-2xl pointer-events-none select-none" 
                                    />
                                </div>

                                <button 
                                    className="hidden md:block absolute right-4 top-1/2 -translate-y-1/2 text-white/50 hover:text-white transition-colors z-[91] p-2" 
                                    onClick={nextLicense}
                                >
                                     <ChevronRight size={48} />
                                </button>

                                {/* Mobile Controls */}
                                <div className="md:hidden absolute bottom-8 left-0 w-full flex justify-center gap-8 z-[91]">
                                     <button onClick={prevLicense} className="p-3 bg-white/10 rounded-full backdrop-blur-sm text-white border border-white/20 active:bg-white/30">
                                        <ChevronLeft size={32} />
                                     </button>
                                     <button onClick={nextLicense} className="p-3 bg-white/10 rounded-full backdrop-blur-sm text-white border border-white/20 active:bg-white/30">
                                        <ChevronRight size={32} />
                                     </button>
                                </div>
                                
                                <div className="absolute bottom-20 md:bottom-6 left-1/2 -translate-x-1/2 text-white/70 text-sm font-medium tracking-widest">
                                    {currentLicenseIndex + 1} / {licenses.length}
                                </div>
                            </div>
                        )}

                        {/* SERVICE SIDEBAR DRAWER */}
                        <div className={`fixed inset-0 z-[60] flex justify-end ${activeService ? 'pointer-events-auto' : 'pointer-events-none'}`}>
                            {/* Backdrop */}
                            <div 
                                className={`absolute inset-0 bg-slate-900/30 backdrop-blur-sm transition-opacity duration-300 ${activeService ? 'opacity-100' : 'opacity-0'}`}
                                onClick={() => setActiveService(null)}
                            ></div>

                            {/* Sidebar Panel */}
                            <div 
                                className={`
                                    relative w-full max-w-md bg-white dark:bg-slate-900 h-full shadow-2xl flex flex-col transform transition-transform duration-300 ease-in-out
                                    ${activeService ? 'translate-x-0' : 'translate-x-full'}
                                `}
                            >
                                {activeService && servicesDetails[activeService] && (
                                    <React.Fragment>
                                        {/* Sidebar Header */}
                                        <div className="p-6 border-b border-slate-100 dark:border-slate-800 flex items-center justify-between bg-slate-50 dark:bg-slate-800">
                                            <div className="flex items-center gap-3">
                                                <div className="w-10 h-10 bg-emerald-100 dark:bg-emerald-900/50 text-emerald-600 dark:text-emerald-400 rounded-xl flex items-center justify-center">
                                                    {React.createElement(servicesDetails[activeService].icon, { size: 24 })}
                                                </div>
                                                <div>
                                                    <h3 className="font-bold text-xl text-slate-900 dark:text-white">{servicesDetails[activeService].title}</h3>
                                                    <p className="text-xs text-slate-500 dark:text-slate-400">{servicesDetails[activeService].subtitle}</p>
                                                </div>
                                            </div>
                                            <button 
                                                onClick={() => setActiveService(null)}
                                                className="p-2 text-slate-400 hover:text-slate-600 dark:hover:text-slate-200 hover:bg-slate-200 dark:hover:bg-slate-700 rounded-full transition-colors"
                                            >
                                                <X size={24} />
                                            </button>
                                        </div>

                                        {/* Sidebar Content */}
                                        <div className="flex-1 overflow-y-auto p-6">
                                            <p className="text-slate-600 dark:text-slate-300 mb-8 leading-relaxed">
                                                {servicesDetails[activeService].description}
                                            </p>

                                            {servicesDetails[activeService].fileList ? (
                                                /* FILE LIST RENDER */
                                                <div className="space-y-4">
                                                    <h4 className="font-bold text-slate-900 dark:text-white mb-4">–î–æ—Å—Ç—É–ø–Ω—ã–µ —Ñ–∞–π–ª—ã:</h4>
                                                    {servicesDetails[activeService].fileList.map((file, i) => (
                                                        <div key={i} className="flex items-start p-4 bg-slate-50 dark:bg-slate-800/50 rounded-xl border border-slate-100 dark:border-slate-700 hover:border-emerald-200 dark:hover:border-emerald-800 transition-colors group cursor-pointer" onClick={() => { if(file.name) window.open(file.desc, '_blank'); }}>
                                                            <div className="p-3 bg-white dark:bg-slate-800 rounded-lg shadow-sm mr-4 text-emerald-600 dark:text-emerald-400">
                                                                {React.createElement(file.iconType || File, { size: 24 })}
                                                            </div>
                                                            <div className="flex-1">
                                                                <h5 className="font-bold text-slate-800 dark:text-slate-200 text-sm mb-1">{file.name}</h5>
                                                                <p className="text-xs text-slate-500 dark:text-slate-400 mb-2">{file.desc}</p>
                                                                <div className="flex items-center gap-3">
                                                                    <span className="text-[10px] font-bold bg-slate-200 dark:bg-slate-700 text-slate-600 dark:text-slate-300 px-2 py-0.5 rounded uppercase">{file.type}</span>
                                                                    <span className="text-[10px] text-slate-400 dark:text-slate-500">{file.size}</span>
                                                                </div>
                                                            </div>
                                                            <div className="self-center">
                                                                <div className="p-2 text-slate-300 dark:text-slate-600 group-hover:text-emerald-500 dark:group-hover:text-emerald-400 transition-colors">
                                                                    <Download size={20} />
                                                                </div>
                                                            </div>
                                                        </div>
                                                    ))}
                                                </div>
                                            ) : servicesDetails[activeService].accordionItems ? (
                                                /* INSTRUCTIONS ACCORDION RENDER */
                                                <div className="space-y-4">
                                                    {servicesDetails[activeService].accordionItems.map((item, i) => (
                                                        <details key={i} className="group bg-slate-50 dark:bg-slate-800 rounded-xl border border-slate-200 dark:border-slate-700 open:border-emerald-200 dark:open:border-emerald-800 transition-colors">
                                                            <summary className="flex items-center justify-between p-4 cursor-pointer font-bold text-slate-800 dark:text-slate-200 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-xl transition-colors">
                                                                <span>{item.title}</span>
                                                                <span className="transform group-open:rotate-180 transition-transform duration-300 text-emerald-500 dark:text-emerald-400">
                                                                    <ChevronDown size={20} />
                                                                </span>
                                                            </summary>
                                                            <div className="px-4 pb-4 pt-2 border-t border-slate-100 dark:border-slate-700 mt-2">
                                                                {item.content}
                                                            </div>
                                                        </details>
                                                    ))}
                                                </div>
                                            ) : servicesDetails[activeService].isPayment ? (
                                                /* PAYMENT RENDER */
                                                <div className="space-y-6">
                                                    <div className="p-4 bg-slate-50 dark:bg-slate-800 rounded-xl border border-slate-100 dark:border-slate-700">
                                                        <h5 className="font-bold text-slate-800 dark:text-white mb-2">QR-–∫–æ–¥ –¥–ª—è –æ–ø–ª–∞—Ç—ã</h5>
                                                        <img src="https://storage.googleapis.com/uspeshnyy-projects/smit/smit34.ru/qr.jpg" alt="QR-–∫–æ–¥" className="w-full rounded-lg shadow-sm mb-4" />
                                                        <h5 className="font-bold text-slate-800 dark:text-white mb-2">–ü–ª–∞—Ç–µ–∂–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã</h5>
                                                        <img src="https://storage.googleapis.com/uspeshnyy-projects/smit/smit34.ru/paysys-medium.jpg" alt="–ü–ª–∞—Ç–µ–∂–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã" className="w-full rounded-lg shadow-sm" />
                                                    </div>
                                                </div>
                                            ) : (
                                                /* DEFAULT SERVICE RENDER */
                                                <>
                                                    <div className="mb-8">
                                                        <h4 className="font-bold text-slate-900 dark:text-white mb-4">–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:</h4>
                                                        <ul className="space-y-3">
                                                            {servicesDetails[activeService].features.map((feature, i) => (
                                                                <li key={i} className="flex items-center gap-3 text-slate-600 dark:text-slate-300 text-sm">
                                                                    <Check size={16} className="text-emerald-500 dark:text-emerald-400" />
                                                                    {feature}
                                                                </li>
                                                            ))}
                                                        </ul>
                                                    </div>

                                                    <div>
                                                        <h4 className="font-bold text-slate-900 dark:text-white mb-4">–¢–∞—Ä–∏—Ñ—ã –∏ —Ü–µ–Ω—ã:</h4>
                                                        <div className="space-y-3">
                                                            {servicesDetails[activeService].prices.map((item, i) => (
                                                                <div key={i} className="flex items-center justify-between p-3 bg-slate-50 dark:bg-slate-800/50 rounded-lg border border-slate-100 dark:border-slate-700 hover:border-emerald-200 dark:hover:border-emerald-800 transition-colors">
                                                                    <div>
                                                                        <div className="font-bold text-slate-800 dark:text-slate-200">{item.name}</div>
                                                                        <div className="text-xs text-slate-500 dark:text-slate-400">{item.detail}</div>
                                                                    </div>
                                                                    <div className="font-bold text-emerald-600 dark:text-emerald-400">{item.price}</div>
                                                                </div>
                                                            ))}
                                                        </div>
                                                    </div>
                                                </>
                                            )}

                                            {servicesDetails[activeService].image && (
                                                 <div className="mt-8">
                                                    <img 
                                                        src={servicesDetails[activeService].image} 
                                                        alt="–ò–ª–ª—é—Å—Ç—Ä–∞—Ü–∏—è" 
                                                        className="w-full rounded-xl shadow-md"
                                                    />
                                                </div>
                                            )}
                                        </div>

                                        {/* Sidebar Footer */}
                                        <div className="p-6 border-t border-slate-100 dark:border-slate-800 bg-slate-50 dark:bg-slate-900">
                                            <Button 
                                                primary 
                                                className="w-full justify-center"
                                                onClick={() => {
                                                    const svc = servicesDetails[activeService];
                                                    if (svc.isPayment) {
                                                        window.open('https://bill.smit34.ru', '_blank');
                                                    } else if (svc.aiMessage) {
                                                        window.openAIWidget && window.openAIWidget(svc.aiMessage);
                                                    }
                                                    setActiveService(null);
                                                }}
                                            >
                                                {servicesDetails[activeService].cta}
                                            </Button>
                                        </div>
                                    </React.Fragment>
                                )}
                            </div>
                        </div>

                        {/* MODAL ‚Äî –∫–æ–Ω—Ç–µ–Ω—Ç –∏–∑ aida.smit34.ru/modal-config */}
                        {showModal && noticeConfig && (
                            <div className="fixed inset-0 z-[70] flex items-center justify-center p-4 animate-in fade-in duration-300">
                                {/* Backdrop */}
                                <div className="absolute inset-0 bg-black/50 backdrop-blur-sm" onClick={() => setShowModal(false)}></div>

                                {/* Modal Content */}
                                <GlassCard className="relative w-full max-w-md mx-auto animate-in fade-in slide-in-from-bottom-4 duration-300 bg-white dark:bg-slate-900 p-0 overflow-hidden">
                                    <button
                                        onClick={() => setShowModal(false)}
                                        className="absolute top-4 right-4 text-white hover:text-slate-100 transition-colors z-10"
                                    >
                                        <X size={24} />
                                    </button>

                                    {/* Header ‚Äî –∑–∞–≥–æ–ª–æ–≤–æ–∫ –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞ */}
                                    <div className="bg-emerald-600 p-6 text-white text-center">
                                        <span className="text-lg font-bold tracking-wide uppercase opacity-90">
                                            {noticeConfig.title || '–í–∞–∂–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è'}
                                        </span>
                                    </div>

                                    {/* Body ‚Äî –±–ª–æ–∫–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞ */}
                                    <div className="p-6 max-h-[60vh] overflow-y-auto custom-scroll space-y-4">
                                        {renderNoticeBlocks(noticeConfig.content)}
                                    </div>

                                    {/* Close button */}
                                    <div className="px-6 pb-5 text-right">
                                        <button onClick={() => setShowModal(false)} className="px-5 py-2 bg-emerald-600 hover:bg-emerald-700 text-white text-sm font-medium rounded-lg transition-colors">
                                            –ó–∞–∫—Ä—ã—Ç—å
                                        </button>
                                    </div>
                                </GlassCard>
                            </div>
                        )}

                        {/* DOCS MODAL */}
                        {activeDoc && (
                            <div className="fixed inset-0 z-[80] flex items-center justify-center p-4 sm:p-6 animate-in fade-in duration-300">
                                <div className="absolute inset-0 bg-slate-900/80 backdrop-blur-sm" onClick={() => setActiveDoc(null)}></div>
                                
                                <div className="relative w-full max-w-4xl h-[90vh] bg-white dark:bg-slate-900 rounded-2xl shadow-2xl overflow-hidden flex flex-col animate-in slide-in-from-bottom-4">
                                    <div className="p-6 border-b border-slate-100 dark:border-slate-800 flex items-center justify-between bg-slate-50 dark:bg-slate-800">
                                        <h2 className="text-2xl font-bold text-slate-900 dark:text-white">
                                            {activeDoc === 'privacy' ? '–ü–æ–ª–∏—Ç–∏–∫–∞ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏' : '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–µ —Å–æ–≥–ª–∞—à–µ–Ω–∏–µ'}
                                        </h2>
                                        <button 
                                            onClick={() => setActiveDoc(null)}
                                            className="p-2 text-slate-400 hover:text-slate-600 dark:hover:text-slate-200 hover:bg-slate-200 dark:hover:bg-slate-700 rounded-full transition-colors"
                                        >
                                            <X size={24} />
                                        </button>
                                    </div>
                                    
                                    <div className="flex-1 overflow-y-auto p-6 sm:p-10 custom-scroll text-slate-800 dark:text-slate-200">
                                        {activeDoc === 'privacy' ? privacyPolicyText : userAgreementText}
                                    </div>
                                    
                                    {/* Footer removed as requested */}
                                </div>
                            </div>
                        )}

                        {/* VOICE AI ASSISTANT */}
                        <AIWidget />

                        {/* COOKIE CONSENT */}
                        {showCookieConsent && (
                            <div className="fixed bottom-6 left-6 z-[90] max-w-sm w-full animate-in slide-in-from-bottom-4 duration-500">
                                <div className="relative rounded-2xl overflow-hidden"
                                    style={{
                                        background: 'rgba(255,255,255,0.18)',
                                        backdropFilter: 'blur(24px)',
                                        WebkitBackdropFilter: 'blur(24px)',
                                        border: '1px solid rgba(255,255,255,0.35)',
                                        boxShadow: '0 8px 32px rgba(0,0,0,0.18), inset 0 1px 0 rgba(255,255,255,0.5)'
                                    }}>
                                    {/* –ì—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–π –±–ª–∏–∫ —Å–≤–µ—Ä—Ö—É */}
                                    <div className="absolute inset-x-0 top-0 h-px bg-gradient-to-r from-transparent via-white/60 to-transparent"></div>
                                    <div className="p-5 flex items-start gap-4">
                                        <div className="p-2.5 rounded-xl shrink-0"
                                            style={{ background: 'rgba(16,185,129,0.15)', backdropFilter: 'blur(8px)', border: '1px solid rgba(16,185,129,0.25)' }}>
                                            <Cookie size={22} className="text-emerald-500 dark:text-emerald-400" />
                                        </div>
                                        <div>
                                            <h4 className="font-bold text-slate-800 dark:text-white mb-1.5 text-sm">–ú—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º cookie</h4>
                                            <p className="text-xs text-slate-600 dark:text-slate-300 mb-3 leading-relaxed">
                                                –î–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã —Å–∞–π—Ç–∞ –∏ –∞–Ω–∞–ª–∏–∑–∞ —Ç—Ä–∞—Ñ–∏–∫–∞. –ü—Ä–æ–¥–æ–ª–∂–∞—è, –≤—ã —Å–æ–≥–ª–∞—à–∞–µ—Ç–µ—Å—å —Å –Ω–∞—à–µ–π <button onClick={() => setActiveDoc('privacy')} className="text-emerald-600 dark:text-emerald-400 hover:underline">–ø–æ–ª–∏—Ç–∏–∫–æ–π</button>.
                                            </p>
                                            <button onClick={handleAcceptCookies}
                                                className="px-4 py-1.5 text-xs font-semibold text-white rounded-lg transition-all"
                                                style={{ background: 'linear-gradient(135deg, #10b981, #059669)', boxShadow: '0 2px 8px rgba(16,185,129,0.4)' }}>
                                                –•–æ—Ä–æ—à–æ
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        )}
                    </div>
                );
            }

            const root = ReactDOM.createRoot(document.getElementById('root'));
            root.render(<App />);
        
        } catch (err) {
            console.error(err);
            document.getElementById('error-display').innerText = "–û—à–∏–±–∫–∞ –∑–∞–ø—É—Å–∫–∞ —Å–∞–π—Ç–∞: " + err.message + "\n\n–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞ (F12) –¥–ª—è –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–µ–π.";
            document.getElementById('error-display').style.display = 'block';
        }
    </script>
</body>
</html>